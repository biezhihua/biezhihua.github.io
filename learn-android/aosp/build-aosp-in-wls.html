<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.20" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.74" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://github.com/biezhihua/learn-android/aosp/build-aosp-in-wls.html"><meta property="og:site_name" content="biezhihuaçš„æ—¥å¸¸"><meta property="og:title" content="Android | AOSP | build aosp and run image to emulator in windows11"><meta property="og:description" content="Android | AOSP | build aosp and run image to emulator in windows11 environment è­¦å‘Š æ³¨æ„ï¼šAOSPä»£ç å¿…é¡»å­˜æ”¾åœ¨WLS2å†…éƒ¨ï¼Œå¦åˆ™åœ¨Windowsä¸Šä¼šäº§ç”Ÿå¾ˆå¤šæœªä¿å­˜æ–‡ä»¶ï¼Œå½±å“åˆ†æ”¯åˆ‡æ¢ï¼Œä»£ç æ›´æ–°ã€‚ wsl2 is migrated to another hard disk å¯..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-03-08T14:25:34.000Z"><meta property="article:tag" content="android"><meta property="article:tag" content="aosp"><meta property="article:modified_time" content="2025-03-08T14:25:34.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Android | AOSP | build aosp and run image to emulator in windows11","image":[""],"dateModified":"2025-03-08T14:25:34.000Z","author":[{"@type":"Person","name":"åˆ«å¿—å","url":"https://github.com/biezhihua"}]}</script><title>Android | AOSP | build aosp and run image to emulator in windows11 | biezhihuaçš„æ—¥å¸¸</title><meta name="description" content="Android | AOSP | build aosp and run image to emulator in windows11 environment è­¦å‘Š æ³¨æ„ï¼šAOSPä»£ç å¿…é¡»å­˜æ”¾åœ¨WLS2å†…éƒ¨ï¼Œå¦åˆ™åœ¨Windowsä¸Šä¼šäº§ç”Ÿå¾ˆå¤šæœªä¿å­˜æ–‡ä»¶ï¼Œå½±å“åˆ†æ”¯åˆ‡æ¢ï¼Œä»£ç æ›´æ–°ã€‚ wsl2 is migrated to another hard disk å¯...">
    <link rel="preload" href="/assets/style-Dh4i2S4S.css" as="style"><link rel="stylesheet" href="/assets/style-Dh4i2S4S.css">
    <link rel="modulepreload" href="/assets/app-D4ZtVCQo.js"><link rel="modulepreload" href="/assets/build-aosp-in-wls.html-DGFAEPtM.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-C4zV9WLq.js" as="script"><link rel="prefetch" href="/assets/about-me.html-Cf4h8-oS.js" as="script"><link rel="prefetch" href="/assets/index.html-DSoLJvLv.js" as="script"><link rel="prefetch" href="/assets/index.html-BdJmG5lO.js" as="script"><link rel="prefetch" href="/assets/difficult-sentence.html-BUWmaLKI.js" as="script"><link rel="prefetch" href="/assets/index.html-C0x6_oDj.js" as="script"><link rel="prefetch" href="/assets/Algorithms-analysis.html-DFFjCGnF.js" as="script"><link rel="prefetch" href="/assets/Algorithms-apply.html-Ca3rKdlm.js" as="script"><link rel="prefetch" href="/assets/Algorithms-math-base.html-Bp2qlH0J.js" as="script"><link rel="prefetch" href="/assets/Algorithms-thinking.html-CnGVX6s-.js" as="script"><link rel="prefetch" href="/assets/Algorithms.html-tS2QeMdZ.js" as="script"><link rel="prefetch" href="/assets/Data-structure.html-i7kM0SU4.js" as="script"><link rel="prefetch" href="/assets/index.html-Ba9BbidO.js" as="script"><link rel="prefetch" href="/assets/algorithms-graph.html-hIE3mu4G.js" as="script"><link rel="prefetch" href="/assets/android-é€†å‘å­¦ä¹ .html-EbakVp3T.js" as="script"><link rel="prefetch" href="/assets/æ»´æ°´ä¸‰æœŸ.html-vPRszmLL.js" as="script"><link rel="prefetch" href="/assets/è®¡ç®—æœºç»„æˆåŸç†.html-Be6CFSqF.js" as="script"><link rel="prefetch" href="/assets/google-android-atrace.html-DqJRsoEz.js" as="script"><link rel="prefetch" href="/assets/google-android-graphics.html-XBVMB1gH.js" as="script"><link rel="prefetch" href="/assets/google-android-performance-overview.html-DdlMZTui.js" as="script"><link rel="prefetch" href="/assets/google-android-profiler.html-CNPt4zZD.js" as="script"><link rel="prefetch" href="/assets/google-android-system.html-Bc73HhZp.js" as="script"><link rel="prefetch" href="/assets/Assembly-Language-4th-Edition-Wang-Shuang.html-DGYFdekO.js" as="script"><link rel="prefetch" href="/assets/Learn-Reverse-Engineering.html-Dkhm6knZ.js" as="script"><link rel="prefetch" href="/assets/SELinux.html-JuvSx1EK.js" as="script"><link rel="prefetch" href="/assets/The-Self-cultivation-of-Programmers-Linking-Loading-and-Libraries.html-CV9Pnkw6.js" as="script"><link rel="prefetch" href="/assets/The-core-principles-of-reverse-engineering.html-C_XiPcYF.js" as="script"><link rel="prefetch" href="/assets/andorid-kernel.html-vOwDzy7_.js" as="script"><link rel="prefetch" href="/assets/android-aar-maven.html-CQQYJNdq.js" as="script"><link rel="prefetch" href="/assets/android-immersive.html-DKkAaWcv.js" as="script"><link rel="prefetch" href="/assets/android-ndk-r18b-toolchains.html-BZwiwNsp.js" as="script"><link rel="prefetch" href="/assets/android-notification-listener-service.html-DBI3rb2D.js" as="script"><link rel="prefetch" href="/assets/android-scrcpy.html-CrGriXxe.js" as="script"><link rel="prefetch" href="/assets/binary-and-hexadecimal-conversion-rules.html-geMoNnFi.js" as="script"><link rel="prefetch" href="/assets/color-difference-calculation.html-DlS36qSx.js" as="script"><link rel="prefetch" href="/assets/color.html-BcDmnFkU.js" as="script"><link rel="prefetch" href="/assets/gradle-commonh-command.html-CvGwNaoe.js" as="script"><link rel="prefetch" href="/assets/how-to-call-rust-function-from-harmony.html-PJYNLFBK.js" as="script"><link rel="prefetch" href="/assets/how-to-extension-method-for-option-in-rust.html-DsOL0Zvp.js" as="script"><link rel="prefetch" href="/assets/how-to-fix-waiting-for-file-lock-on-package-cache.html-Biw15_Zc.js" as="script"><link rel="prefetch" href="/assets/how-to-get-multi-option-value.html-B7jR-ZEU.js" as="script"><link rel="prefetch" href="/assets/how-to-ignore-warning-info-in-rust.html-CIGMzXEM.js" as="script"><link rel="prefetch" href="/assets/how-to-mount-remote-disk-to-local.html-BDCop1IG.js" as="script"><link rel="prefetch" href="/assets/how-to-process-common-error.html-D0YJEBTN.js" as="script"><link rel="prefetch" href="/assets/how-to-read-config-file-of-lib-project-in-rust.html-ClfWU_VA.js" as="script"><link rel="prefetch" href="/assets/how-to-use-result-process-option-in-rust.html-maX0lJxR.js" as="script"><link rel="prefetch" href="/assets/hypervisor.html-C8yic_v-.js" as="script"><link rel="prefetch" href="/assets/learn-compilers.html-B2yXhS-t.js" as="script"><link rel="prefetch" href="/assets/learn-ida.html-Cy82ndNB.js" as="script"><link rel="prefetch" href="/assets/learn-rust.html-TE61EtSZ.js" as="script"><link rel="prefetch" href="/assets/learn-stable-diffusion.html-CRgFCCXi.js" as="script"><link rel="prefetch" href="/assets/learn-ui-design-UIè®¾è®¡å¿…ä¿®è¯¾-äº¤äº’-æ¶æ„-è§†è§‰UIè®¾è®¡æ•™ç¨‹.html-D2QZJkjj.js" as="script"><link rel="prefetch" href="/assets/learn-windows-linux.html-C0fBrFE5.js" as="script"><link rel="prefetch" href="/assets/lr1-detail.html-bsP3QLhm.js" as="script"><link rel="prefetch" href="/assets/lr1-detail2.html-BxtISUFv.js" as="script"><link rel="prefetch" href="/assets/lr1-detail3.html-DrXYHlcf.js" as="script"><link rel="prefetch" href="/assets/lr1-detail4.html-BDjJK3f2.js" as="script"><link rel="prefetch" href="/assets/lr1-äº§ç”Ÿå¼æ˜¯å¦‚ä½•å®šä¹‰çš„.html-VahRyyY2.js" as="script"><link rel="prefetch" href="/assets/lr1.html-DlAQqHPA.js" as="script"><link rel="prefetch" href="/assets/math-lerp.html-DTsniZLi.js" as="script"><link rel="prefetch" href="/assets/mhxy-navgiate-mode.html-CGBqsZow.js" as="script"><link rel="prefetch" href="/assets/mhxy-script.html-CAcRaXRB.js" as="script"><link rel="prefetch" href="/assets/pc-platform-arch-info.html-dWTGFuqe.js" as="script"><link rel="prefetch" href="/assets/pyhont-callable.html-CXTsTlRR.js" as="script"><link rel="prefetch" href="/assets/python-async-await-threading.html-OCXdxKis.js" as="script"><link rel="prefetch" href="/assets/python-async-await.html-Bmyou2nn.js" as="script"><link rel="prefetch" href="/assets/python-async-block-unblock.html-CKOvW4Et.js" as="script"><link rel="prefetch" href="/assets/python-async.html-B4bcvaiZ.js" as="script"><link rel="prefetch" href="/assets/python-dict.html-B9bziZKO.js" as="script"><link rel="prefetch" href="/assets/python-singleton-decorator.html-gBJ5dWhZ.js" as="script"><link rel="prefetch" href="/assets/python-singleton.html-DonymG_8.js" as="script"><link rel="prefetch" href="/assets/pythopn-opencv-hist.html-DMxy53Si.js" as="script"><link rel="prefetch" href="/assets/quickjs-eval-flags.html-CV57cvGS.js" as="script"><link rel="prefetch" href="/assets/quickjs-eval.html-BT1rju12.js" as="script"><link rel="prefetch" href="/assets/reverse-engineering-1.html-CIoIV4xA.js" as="script"><link rel="prefetch" href="/assets/reverse-engineering-2.html-Dp-m5wTC.js" as="script"><link rel="prefetch" href="/assets/reverse-engineering-3.html-C5s3afM8.js" as="script"><link rel="prefetch" href="/assets/reverse-engineering-windows-1.html-BWGplWHV.js" as="script"><link rel="prefetch" href="/assets/reverse-engineering-windows-2.html-C0MRgCQE.js" as="script"><link rel="prefetch" href="/assets/root-magisk-xposed-lsposed.html-BwZGiI27.js" as="script"><link rel="prefetch" href="/assets/solution-rust-diesel-install-in-windows.html-z3HOtLCm.js" as="script"><link rel="prefetch" href="/assets/using-opencv-4-surf-algorithm-feature-detection-quoc-bao-nguyen.html-Bw8aKlfB.js" as="script"><link rel="prefetch" href="/assets/vm1.html-HQDrQOug.js" as="script"><link rel="prefetch" href="/assets/vm2.html-CLS-jYkA.js" as="script"><link rel="prefetch" href="/assets/vm3.html-CVWCWpKv.js" as="script"><link rel="prefetch" href="/assets/vm4.html-TKm6E-Qj.js" as="script"><link rel="prefetch" href="/assets/vmx.html-F8tqsiOW.js" as="script"><link rel="prefetch" href="/assets/what-is-the-COM-in-windows.html-CnO3Ibwj.js" as="script"><link rel="prefetch" href="/assets/what-is-the-epoll.html-DI_wVGpX.js" as="script"><link rel="prefetch" href="/assets/what-is-the-file-descriptor.html-BRERWEeW.js" as="script"><link rel="prefetch" href="/assets/what-is-the-meaning-of-__no_mangle_.html-B_P_vw_p.js" as="script"><link rel="prefetch" href="/assets/what-is-the-meaning-of-__repr(C)_.html-DUVHPnRT.js" as="script"><link rel="prefetch" href="/assets/what-is-the-varargs-in-python.html-DkGHyf08.js" as="script"><link rel="prefetch" href="/assets/what-the-different-self-and-Self-in-Rust.html-BUQhz4B8.js" as="script"><link rel="prefetch" href="/assets/windows-SystemFirmwareTable.html-lPKJmx1N.js" as="script"><link rel="prefetch" href="/assets/windows-dev.html-pZmjLgoA.js" as="script"><link rel="prefetch" href="/assets/app-launch.html-B2uiSRu3.js" as="script"><link rel="prefetch" href="/assets/extend.html-Bhb3cDLF.js" as="script"><link rel="prefetch" href="/assets/surfaceflinger-init.html-BslSBihM.js" as="script"><link rel="prefetch" href="/assets/surfaceflinger-vsync.html-BwCPt-F2.js" as="script"><link rel="prefetch" href="/assets/zygote.html-Bl8-8maX.js" as="script"><link rel="prefetch" href="/assets/perfetto-00-outline.html-hzvcH96z.js" as="script"><link rel="prefetch" href="/assets/perfetto-01-overview.html-CdpIp4kG.js" as="script"><link rel="prefetch" href="/assets/perfetto-02-tracing-101.html-Brj2xwGg.js" as="script"><link rel="prefetch" href="/assets/perfetto-03-quickstart-record-traces-on-android.html-VeOAsvu1.js" as="script"><link rel="prefetch" href="/assets/perfetto-06-quickstart-sql-analysis-and-metrics copy.html-D_JciCmg.js" as="script"><link rel="prefetch" href="/assets/perfetto-07-quickstart-trace-conversion copy.html-C8tBiL-K.js" as="script"><link rel="prefetch" href="/assets/perfetto-08-quickstart-heap-profiling copy.html-QJr-bM3A.js" as="script"><link rel="prefetch" href="/assets/perfetto-09-quickstart-callstack-sampling-on-android copy.html-D9i1rg8U.js" as="script"><link rel="prefetch" href="/assets/perfetto-10-faq.html-BhxYDDVK.js" as="script"><link rel="prefetch" href="/assets/perfetto-11-case-stuides-android-boot-tracing.html-CkjSLP-_.js" as="script"><link rel="prefetch" href="/assets/perfetto-12-data-sources-debugging-memory-usage.html-DJ62Ii5z.js" as="script"><link rel="prefetch" href="/assets/perfetto-13-data-sources-memory-counter-and-events.html-BzGFd-f6.js" as="script"><link rel="prefetch" href="/assets/perfetto-14-data-sources-memory-heap-profiler.html-D_7S8bH-.js" as="script"><link rel="prefetch" href="/assets/perfetto-15-data-sources-java-heap-dumps.html-Bzff_pzf.js" as="script"><link rel="prefetch" href="/assets/perfetto-16-data-sources-cpu-scheduling-events.html-P42wxRp-.js" as="script"><link rel="prefetch" href="/assets/perfetto-17-data-sources-system-calls.html-B7GNWg5J.js" as="script"><link rel="prefetch" href="/assets/perfetto-18-data-sources-cpu-frequency-scaling.html-fRfoZFFt.js" as="script"><link rel="prefetch" href="/assets/perfetto-21-android-system-android-game-intervention-list.html-B58U3uVN.js" as="script"><link rel="prefetch" href="/assets/perfetto-22-data-sources-android-system-atrace-instrumentation.html-CWnpcZq8.js" as="script"><link rel="prefetch" href="/assets/perfetto-23-data-sources-android-system-android-log.html-j1OmiyjF.js" as="script"><link rel="prefetch" href="/assets/perfetto-24-data-sources-android-system-android-jank.html-DzQo45XX.js" as="script"><link rel="prefetch" href="/assets/perfetto-25-app-instrumentation-tracing-sdk.html-6zlcqJyF.js" as="script"><link rel="prefetch" href="/assets/perfetto-28-trace-analysis-trace-processor.html-DVad_rJN.js" as="script"><link rel="prefetch" href="/assets/perfetto-41-core-concepts-trace-configuration.html-B1WV4IGd.js" as="script"><link rel="prefetch" href="/assets/perfetto-42-core-concepts-buffers-and-dataflow.html-26b83XEG.js" as="script"><link rel="prefetch" href="/assets/perfetto-43-core-concepts-service-model.html-Dh8rF9pR.js" as="script"><link rel="prefetch" href="/assets/fluency-00-outline.html-9v9sLsZ8.js" as="script"><link rel="prefetch" href="/assets/fluency-01-overview.html-D18RvKql.js" as="script"><link rel="prefetch" href="/assets/fluency-02-fps.html-DqrXg_fw.js" as="script"><link rel="prefetch" href="/assets/fluency-03-observability-technology.html-BCQ6eBBD.js" as="script"><link rel="prefetch" href="/assets/fluency-04-tracing.html-BxBqkKs3.js" as="script"><link rel="prefetch" href="/assets/fluency-05-tools-perfetto.html-B-lGDNfr.js" as="script"><link rel="prefetch" href="/assets/fluency-06-tools-android-profiler.html-CFGSLilW.js" as="script"><link rel="prefetch" href="/assets/fluency-07-perfetto-android-overview.html-Bd8tk33b.js" as="script"><link rel="prefetch" href="/assets/fluency-08-perfetto-android-graphics-vsync.html-DZABqd5i.js" as="script"><link rel="prefetch" href="/assets/index.html-DutdUir0.js" as="script"><link rel="prefetch" href="/assets/native-crash.html-BmBhpMy2.js" as="script"><link rel="prefetch" href="/assets/overview.html-Dlvuir73.js" as="script"><link rel="prefetch" href="/assets/index.html-CNlFo6UT.js" as="script"><link rel="prefetch" href="/assets/6.006 Introduction To Algorithms.html-B3-nDJM-.js" as="script"><link rel="prefetch" href="/assets/6.042J Undergraduate Mathematics For Computer Science.html-BBcdsZ4L.js" as="script"><link rel="prefetch" href="/assets/6.046J Design And Analysis Of Algorithms.html-CQjMZs1E.js" as="script"><link rel="prefetch" href="/assets/6.828 Operating System Engineering.html-CWVZX5x2.js" as="script"><link rel="prefetch" href="/assets/6.851 Advanced Data Structures.html-Cx138J4U.js" as="script"><link rel="prefetch" href="/assets/6.854J Advanced Alorithms.html-DCkTgsc7.js" as="script"><link rel="prefetch" href="/assets/Lesson-01-A-private-conversation.html-CbRb8Rbd.js" as="script"><link rel="prefetch" href="/assets/Lesson-02-Breakfast-or-lunch.html-DbhUBok2.js" as="script"><link rel="prefetch" href="/assets/Lesson-03-Please-send-me-a-card.html-BJT5zzOQ.js" as="script"><link rel="prefetch" href="/assets/Lesson-04-An-exciting-trip.html-DhdFB_Ex.js" as="script"><link rel="prefetch" href="/assets/Lesson-05-No-Wrong-Numbers.html-BMJhHvd8.js" as="script"><link rel="prefetch" href="/assets/Lesson-06-Percy-Buttons.html-BCqndwar.js" as="script"><link rel="prefetch" href="/assets/Lesson-07-Too-late.html-XwbdL2oh.js" as="script"><link rel="prefetch" href="/assets/Lesson-08-The-best-and-the-worst.html-wkMJ2NW6.js" as="script"><link rel="prefetch" href="/assets/Lesson-09-A-cold-welcome.html-racwImmH.js" as="script"><link rel="prefetch" href="/assets/Lesson-10-Not-For-Jazz.html-BPYp2pbJ.js" as="script"><link rel="prefetch" href="/assets/Lesson-11-One-good-turn-deserves-another.html-ChoWMjP6.js" as="script"><link rel="prefetch" href="/assets/Lesson-12-Goodbye-and-good-luck.html-BM9Ipo0T.js" as="script"><link rel="prefetch" href="/assets/Lesson-13-The-Greenwood-Boys.html-41cUxrRn.js" as="script"><link rel="prefetch" href="/assets/Lesson-14-Do-you-speak-English.html-DZuyxMdf.js" as="script"><link rel="prefetch" href="/assets/Lesson-15-Good-news.html-BHAf66Kt.js" as="script"><link rel="prefetch" href="/assets/Lesson-16-A-polite-request.html-Cd7qpU7o.js" as="script"><link rel="prefetch" href="/assets/Lesson-17-Always-young.html-D4szTRp3.js" as="script"><link rel="prefetch" href="/assets/Lesson-18-He-often-does-this.html-B1dpmok4.js" as="script"><link rel="prefetch" href="/assets/Lesson-19-Sold-out.html-B-Hlhfb9.js" as="script"><link rel="prefetch" href="/assets/Lesson-20-One-man-in-a-boat.html-DihEj2YW.js" as="script"><link rel="prefetch" href="/assets/Lesson-21-Mad-or-not.html-BioUhRPe.js" as="script"><link rel="prefetch" href="/assets/Lesson-22-A-glass-envelope.html-0a1Acuiw.js" as="script"><link rel="prefetch" href="/assets/Lesson-23-A-new-house.html-YCmTTP1F.js" as="script"><link rel="prefetch" href="/assets/Lesson-24-If-could-be-worse.html-BPnk4Oj3.js" as="script"><link rel="prefetch" href="/assets/Lesson-25-Do-the-English-speak-English.html-DyNCBMjZ.js" as="script"><link rel="prefetch" href="/assets/Lesson-26-The-best-art-critics.html-BsiIqzR0.js" as="script"><link rel="prefetch" href="/assets/Lesson-27-A-wet-night.html-EfTiBh_R.js" as="script"><link rel="prefetch" href="/assets/Lesson-28-No-parking.html-DeoApbSf.js" as="script"><link rel="prefetch" href="/assets/Lesson-29-Taxi.html-CLRc52dF.js" as="script"><link rel="prefetch" href="/assets/Lesson-30-Football-or-polo.html-CtdmgM9e.js" as="script"><link rel="prefetch" href="/assets/Lesson-31-Success-story.html-DdPzJ2OY.js" as="script"><link rel="prefetch" href="/assets/Lesson-32-Shopping-make-easy.html-HJnOc7oC.js" as="script"><link rel="prefetch" href="/assets/Lesson-33-Out-of-the-darkness.html-BK2jZRQC.js" as="script"><link rel="prefetch" href="/assets/Lesson-34-Quick-work.html-CGTAFNkt.js" as="script"><link rel="prefetch" href="/assets/Lesson-35-Stop-thief.html-CIOyVBWt.js" as="script"><link rel="prefetch" href="/assets/Lesson-36-Across-the-Channel.html-DbCuFgkE.js" as="script"><link rel="prefetch" href="/assets/Lesson-37-The-Olympic-Games.html-D0OwY9oV.js" as="script"><link rel="prefetch" href="/assets/Lesson-38-Everything-except-the-weather.html-BsBA04K5.js" as="script"><link rel="prefetch" href="/assets/Lesson-39-Am-I-all-right.html-D5IpEe9x.js" as="script"><link rel="prefetch" href="/assets/Lesson-40-Food-and-talk.html-DloN_l-H.js" as="script"><link rel="prefetch" href="/assets/Lesson-41-Do-you-call-that-a-hat.html-C-ees3FI.js" as="script"><link rel="prefetch" href="/assets/Lesson-42-Not-very-musical.html-CLhHj1fg.js" as="script"><link rel="prefetch" href="/assets/Lesson-43-Over-the-South-Pole.html-NRLKx5xv.js" as="script"><link rel="prefetch" href="/assets/Lesson-44-Through-the-forest.html-DBpLf4Bz.js" as="script"><link rel="prefetch" href="/assets/Lesson-45-A-clear-conscience.html-BrQ2OQKA.js" as="script"><link rel="prefetch" href="/assets/Lesson-46-Expensive-and-uncomfortable.html-GyKrF5la.js" as="script"><link rel="prefetch" href="/assets/Lesson-47-A-thirsty-ghost.html-q7p1v1P4.js" as="script"><link rel="prefetch" href="/assets/Lesson-48-Did-you-want-to-tell-me-something.html-D5fAVaYw.js" as="script"><link rel="prefetch" href="/assets/Lesson-49-The-end-of-a-dream.html-JzlingEk.js" as="script"><link rel="prefetch" href="/assets/Lesson-50-Taken-for-a-ride.html-BI5k08Fy.js" as="script"><link rel="prefetch" href="/assets/Lesson-51-Reward-for-virtue.html-Dky9uUSN.js" as="script"><link rel="prefetch" href="/assets/Lesson-52-A-pretty-carpet.html-DC_-4koU.js" as="script"><link rel="prefetch" href="/assets/Lesson-53-Hot-snake.html-DqhR4mX-.js" as="script"><link rel="prefetch" href="/assets/Lesson-54-Sticky-fingers.html-dbKFz6Sw.js" as="script"><link rel="prefetch" href="/assets/Lesson-55-Not-a-gold-mine.html-BZlenJQr.js" as="script"><link rel="prefetch" href="/assets/Lesson-56-Faster-than-sound.html-Cs4BhQrZ.js" as="script"><link rel="prefetch" href="/assets/Lesson-57-Can-I-help-you_-madam.html-njtsf09Z.js" as="script"><link rel="prefetch" href="/assets/Lesson-58-A-blessing-in-disguise.html-Bw4nrES4.js" as="script"><link rel="prefetch" href="/assets/Lesson-59-In-or-out.html-CB9E11b1.js" as="script"><link rel="prefetch" href="/assets/Lesson-60-The-future.html-BwpwTlxL.js" as="script"><link rel="prefetch" href="/assets/Lesson-61-Trouble-with-the-Hubble.html-BlF03bWg.js" as="script"><link rel="prefetch" href="/assets/Lesson-62-After-the-fire.html-BGaFpsoE.js" as="script"><link rel="prefetch" href="/assets/Lesson-63-She-was-not-amused.html-CcHmoVfS.js" as="script"><link rel="prefetch" href="/assets/Lesson-64-The-Channel-Tunnel.html-B8AZRZ8H.js" as="script"><link rel="prefetch" href="/assets/Lesson-65-Jumbo-versus-the-police.html-7z_8Qpr6.js" as="script"><link rel="prefetch" href="/assets/Lesson-66-Sweet-as-honey.html-DtfCewhX.js" as="script"><link rel="prefetch" href="/assets/Lesson-67-Volcanoes.html-BW5z7NAm.js" as="script"><link rel="prefetch" href="/assets/Lesson-68-Persistent.html-fxjdhzE5.js" as="script"><link rel="prefetch" href="/assets/Lesson-69-But-not-murder.html-DCs2t3Fh.js" as="script"><link rel="prefetch" href="/assets/Lesson-70-Red-for-danger.html-D1VgPpR4.js" as="script"><link rel="prefetch" href="/assets/Lesson-71-A-famous-clock.html-Bjv4R_D0.js" as="script"><link rel="prefetch" href="/assets/Lesson-72-A-car-called-bluebird.html-b-fkH2pT.js" as="script"><link rel="prefetch" href="/assets/Lesson-73-The-record-holder.html-D3eKIQZr.js" as="script"><link rel="prefetch" href="/assets/Lesson-74-Out-of-the-limelight.html-BKY6_SjK.js" as="script"><link rel="prefetch" href="/assets/Lesson-75-SOS.html-5pGy-I08.js" as="script"><link rel="prefetch" href="/assets/Lesson-76-April-Fools-Day.html-B0hqT1U7.js" as="script"><link rel="prefetch" href="/assets/Lesson-77-Successful-operation.html-Cz7uJ2iD.js" as="script"><link rel="prefetch" href="/assets/Lesson-78-The-last-one.html-BYk49aJP.js" as="script"><link rel="prefetch" href="/assets/Lesson-79-By-air.html-BuLS-RuA.js" as="script"><link rel="prefetch" href="/assets/Lesson-80-The-Crystal-Palace.html-BIQh0b4-.js" as="script"><link rel="prefetch" href="/assets/Lesson-81-Escape.html-2YTj5Cqj.js" as="script"><link rel="prefetch" href="/assets/Lesson-82-Monster-or-fish.html-CafQpG8J.js" as="script"><link rel="prefetch" href="/assets/Lesson-83-After-the-elections.html-mzEI6dGM.js" as="script"><link rel="prefetch" href="/assets/Lesson-84-On-strike.html-DxXiFTUn.js" as="script"><link rel="prefetch" href="/assets/Lesson-85-Never-too-old-to-learn.html-qaqFK0ms.js" as="script"><link rel="prefetch" href="/assets/Lesson-86-Out-of-control.html-BhFkG9cq.js" as="script"><link rel="prefetch" href="/assets/Lesson-87-A-perfect-alibi.html-qjTwayhM.js" as="script"><link rel="prefetch" href="/assets/Lesson-88-Trapped-in-a-mine.html-D8EwMneE.js" as="script"><link rel="prefetch" href="/assets/Lesson-89-A-slip-of-the-tongue.html-D2Pa035-.js" as="script"><link rel="prefetch" href="/assets/Lesson-90-What-is-for-supper.html-2NR3wbMs.js" as="script"><link rel="prefetch" href="/assets/Lesson-91-Three-men-in-a-basket.html-B1wetG0G.js" as="script"><link rel="prefetch" href="/assets/Lesson-92-Asking-for-trouble.html-Cina1di1.js" as="script"><link rel="prefetch" href="/assets/Lesson-93-A-noble-gift.html-DwrHXxDo.js" as="script"><link rel="prefetch" href="/assets/Lesson-94-Future-champions.html-DBOYowka.js" as="script"><link rel="prefetch" href="/assets/Lesson-95-A-fantasy.html-BOfgOaan.js" as="script"><link rel="prefetch" href="/assets/Lesson-96-The-dead-return.html-BiaaVZYe.js" as="script"><link rel="prefetch" href="/assets/404.html-B31wzwOT.js" as="script"><link rel="prefetch" href="/assets/index.html-VHE6FLl6.js" as="script"><link rel="prefetch" href="/assets/index.html-D8TC0pRL.js" as="script"><link rel="prefetch" href="/assets/index.html-D4olCJ5i.js" as="script"><link rel="prefetch" href="/assets/index.html-DDI9Smw8.js" as="script"><link rel="prefetch" href="/assets/index.html-CamaCKp9.js" as="script"><link rel="prefetch" href="/assets/index.html-zUSHmJFo.js" as="script"><link rel="prefetch" href="/assets/index.html-BZ_WOyFF.js" as="script"><link rel="prefetch" href="/assets/index.html-DRE-DOHc.js" as="script"><link rel="prefetch" href="/assets/index.html-A0RrQaja.js" as="script"><link rel="prefetch" href="/assets/index.html-D1BapVIZ.js" as="script"><link rel="prefetch" href="/assets/index.html-BVi462kd.js" as="script"><link rel="prefetch" href="/assets/index.html-By9XNdH1.js" as="script"><link rel="prefetch" href="/assets/index.html-DGsafpwZ.js" as="script"><link rel="prefetch" href="/assets/index.html-aM9Wz1Ts.js" as="script"><link rel="prefetch" href="/assets/index.html-DVUMXMTH.js" as="script"><link rel="prefetch" href="/assets/index.html-5ojDc-tG.js" as="script"><link rel="prefetch" href="/assets/index.html-B-6DwDJC.js" as="script"><link rel="prefetch" href="/assets/index.html-0h-pQqie.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-DXWKOczD.js" as="script"><link rel="prefetch" href="/assets/setupDevtools-QXEOFQJV-CqhvpUNn.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container no-sidebar external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/" aria-label="å¸¦æˆ‘å›å®¶"><img class="vp-nav-logo" src="/images/favicon-32x32.png" alt><!----><span class="vp-site-name hide-in-pad">biezhihuaçš„æ—¥å¸¸</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="LeetCode"><!--[--><!---->LeetCode<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/learn-leetcode/" aria-label="å­¦ä¹ å¤§çº²" iconsizing="both"><!---->å­¦ä¹ å¤§çº²<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/learn-leetcode/Algorithms-analysis.html" aria-label="ç®—æ³•åˆ†æ" iconsizing="both"><!---->ç®—æ³•åˆ†æ<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/learn-leetcode/Algorithms-thinking.html" aria-label="ç®—æ³•æ€æƒ³" iconsizing="both"><!---->ç®—æ³•æ€æƒ³<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/learn-leetcode/Algorithms.html" aria-label="ç®—æ³•" iconsizing="both"><!---->ç®—æ³•<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/learn-leetcode/Data-structure.html" aria-label="æ•°æ®ç»“æ„" iconsizing="both"><!---->æ•°æ®ç»“æ„<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/learn-leetcode/Algorithms-math-base.html" aria-label="æ•°å­¦åŸºç¡€" iconsizing="both"><!---->æ•°å­¦åŸºç¡€<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/learn-leetcode/Algorithms-apply.html" aria-label="ç®—æ³•åº”ç”¨" iconsizing="both"><!---->ç®—æ³•åº”ç”¨<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="English"><!--[--><!---->English<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/learn-english/" aria-label="å­¦ä¹ å¤§çº²" iconsizing="both"><!---->å­¦ä¹ å¤§çº²<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/learn-english/NCE/" aria-label="æ–°æ¦‚å¿µ" iconsizing="both"><!---->æ–°æ¦‚å¿µ<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/learn-english/difficult-sentence.html" aria-label="ç–‘éš¾å¥åˆ†æ" iconsizing="both"><!---->ç–‘éš¾å¥åˆ†æ<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/about-me.html" aria-label="AboutMe" iconsizing="height"><!---->AboutMe<!----></a></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!----><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Android | AOSP | build aosp and run image to emulator in windows11</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/biezhihua" target="_blank" rel="noopener noreferrer">åˆ«å¿—å</a></span><span property="author" content="åˆ«å¿—å"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2023å¹´3æœˆ14æ—¥</span><meta property="datePublished" content="2023-03-14T05:02:56.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 18 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT18M"></span><!----><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color3" role>android</span><span class="page-tag-item color4" role>aosp</span><!--]--><meta property="keywords" content="android,aosp"></span></div><hr></div><!----><!----><div class="theme-hope-content" vp-content><h1 id="android-aosp-build-aosp-and-run-image-to-emulator-in-windows11" tabindex="-1"><a class="header-anchor" href="#android-aosp-build-aosp-and-run-image-to-emulator-in-windows11"><span>Android | AOSP | build aosp and run image to emulator in windows11</span></a></h1><h2 id="environment" tabindex="-1"><a class="header-anchor" href="#environment"><span>environment</span></a></h2><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>// å®¿ä¸»ç³»ç»Ÿ</span></span>
<span class="line"><span>Windows11</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// ç¼–è¯‘aospç³»ç»Ÿ</span></span>
<span class="line"><span>WSL2 - Ubuntu-18.04</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// aospåˆ†æ”¯</span></span>
<span class="line"><span>android-13.0.0_r41</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container caution"><p class="hint-container-title">è­¦å‘Š</p><p>æ³¨æ„ï¼šAOSPä»£ç å¿…é¡»å­˜æ”¾åœ¨WLS2å†…éƒ¨ï¼Œå¦åˆ™åœ¨Windowsä¸Šä¼šäº§ç”Ÿå¾ˆå¤šæœªä¿å­˜æ–‡ä»¶ï¼Œå½±å“åˆ†æ”¯åˆ‡æ¢ï¼Œä»£ç æ›´æ–°ã€‚</p></div><h2 id="wsl2-is-migrated-to-another-hard-disk" tabindex="-1"><a class="header-anchor" href="#wsl2-is-migrated-to-another-hard-disk"><span>wsl2 is migrated to another hard disk</span></a></h2><p>å¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤å°† WSL2 è¿ç§»è‡³å…¶ä»–ç¡¬ç›˜ï¼š</p><ol><li>å…³é—­ WSL2</li></ol><p>é¦–å…ˆéœ€è¦å…³é—­æ­£åœ¨è¿è¡Œçš„ WSL2ï¼Œå¯ä»¥åœ¨ PowerShell æˆ– CMD ä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wsl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --shutdown</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li>å¯¼å‡º WSL2 é•œåƒ</li></ol><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯¼å‡º WSL2 é•œåƒï¼Œå…¶ä¸­ <code>&lt;distribution&gt;</code> æ˜¯è¦å¯¼å‡ºçš„å‘è¡Œç‰ˆçš„åç§°ï¼Œ<code>&lt;file&gt;</code> æ˜¯å¯¼å‡ºçš„æ–‡ä»¶åå’Œè·¯å¾„ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wsl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --export</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">distributio</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">n&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">fil</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="3"><li>åˆ é™¤æ—§çš„ WSL2 é•œåƒ</li></ol><p>åœ¨å¯¼å‡ºé•œåƒä¹‹å‰ï¼Œéœ€è¦åˆ é™¤åŸæ¥çš„ WSL2 é•œåƒã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤åˆ—å‡ºå·²å®‰è£…çš„ WSL2 å‘è¡Œç‰ˆï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wsl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --list</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --verbose</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç„¶åé€šè¿‡ä»¥ä¸‹å‘½ä»¤åˆ é™¤æŒ‡å®šçš„ WSL2 å‘è¡Œç‰ˆï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wsl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --unregister</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">distributio</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">n&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="4"><li>å¯¼å…¥ WSL2 é•œåƒ</li></ol><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯¼å…¥ WSL2 é•œåƒï¼Œå…¶ä¸­ <code>&lt;distribution&gt;</code> æ˜¯è¦å¯¼å…¥çš„å‘è¡Œç‰ˆçš„åç§°ï¼Œ<code>&lt;file&gt;</code> æ˜¯å¯¼å‡ºçš„æ–‡ä»¶åå’Œè·¯å¾„ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wsl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">distributio</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">n&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">director</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">fil</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å…¶ä¸­ <code>&lt;directory&gt;</code> æ˜¯æ–°çš„ WSL2 é•œåƒç›®å½•çš„è·¯å¾„ã€‚</p><ol start="5"><li>å¯åŠ¨æ–°çš„ WSL2</li></ol><p>é€šè¿‡ä»¥ä¸‹å‘½ä»¤å¯åŠ¨æ–°çš„ WSL2ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wsl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">distributio</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">n&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å…¶ä¸­ <code>&lt;distribution&gt;</code> æ˜¯è¦å¯åŠ¨çš„å‘è¡Œç‰ˆçš„åç§°ã€‚</p><p>æ³¨æ„ï¼šåœ¨è¿›è¡Œä¸Šè¿°æ“ä½œæ—¶ï¼Œè¯·ç¡®ä¿å¤‡ä»½é‡è¦æ•°æ®å¹¶äº†è§£é£é™©ã€‚</p><ul><li><a href="https://blog.csdn.net/zyb418/article/details/124114683" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/zyb418/article/details/124114683</a></li></ul><h2 id="wls2-expand-the-capacity-of-ubuntu-18-04" tabindex="-1"><a class="header-anchor" href="#wls2-expand-the-capacity-of-ubuntu-18-04"><span>wls2 expand the capacity of ubuntu-18.04</span></a></h2><ul><li><a href="https://learn.microsoft.com/zh-cn/windows/wsl/disk-space" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/zh-cn/windows/wsl/disk-space</a></li><li><a href="https://www.jianshu.com/p/2348dc7e9aef" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/2348dc7e9aef</a></li><li><a href="https://learn.microsoft.com/zh-cn/windows-server/administration/windows-commands/expand-vdisk" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/zh-cn/windows-server/administration/windows-commands/expand-vdisk</a></li></ul><h2 id="å¦‚ä½•ç»™wls2-ubuntu18-0-4-æ‰©å……ç£ç›˜å®¹é‡" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ç»™wls2-ubuntu18-0-4-æ‰©å……ç£ç›˜å®¹é‡"><span>å¦‚ä½•ç»™WLS2-Ubuntu18.0.4 æ‰©å……ç£ç›˜å®¹é‡</span></a></h2><p>åœ¨ WSL2 (Windows Subsystem for Linux 2) ä¸­ï¼ŒUbuntu 18.04 é»˜è®¤ä¼šå°†ç£ç›˜å­˜å‚¨ä¸ºä¸€ä¸ª VHDX æ–‡ä»¶ã€‚è¦æ‰©å±• WSL2 Ubuntu 18.04 çš„ç£ç›˜å®¹é‡ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p><p><strong>æ­¥éª¤ 1</strong>ï¼šå…³é—­ WSL2 å®ä¾‹ã€‚åœ¨ Windows PowerShell æˆ–å‘½ä»¤æç¤ºç¬¦ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wsl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --shutdown</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>æ­¥éª¤ 2</strong>ï¼šæ‰¾åˆ° VHDX æ–‡ä»¶ã€‚WSL2 å®ä¾‹çš„ VHDX æ–‡ä»¶é€šå¸¸ä½äº <code>C:\Users\&lt;YourUsername&gt;\AppData\Local\Packages\</code> ç›®å½•ä¸‹ã€‚ç„¶åè¿›å…¥ä¸€ä¸ªåä¸º <code>CanonicalGroupLimited.Ubuntu18.04onWindows_79rhkp1fndgsc</code>ï¼ˆè¿™ä¸ªåå­—å¯èƒ½ç•¥æœ‰ä¸åŒï¼‰çš„æ–‡ä»¶å¤¹ã€‚æ¥ä¸‹æ¥ï¼Œè¿›å…¥ <code>LocalState</code> æ–‡ä»¶å¤¹ã€‚åœ¨æ­¤æ–‡ä»¶å¤¹ä¸­ï¼Œæ‚¨åº”è¯¥å¯ä»¥æ‰¾åˆ°åä¸º <code>ext4.vhdx</code> çš„æ–‡ä»¶ã€‚</p><p><strong>æ­¥éª¤ 3</strong>ï¼šæ‰©å±• VHDX æ–‡ä»¶ã€‚é¦–å…ˆï¼Œæ‰“å¼€ Windows PowerShell æˆ–å‘½ä»¤æç¤ºç¬¦ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œã€‚ç„¶åï¼Œä½¿ç”¨ <code>Resize-VHD</code> å‘½ä»¤æ‰©å±• VHDX æ–‡ä»¶ã€‚å°† <code>&lt;YourPath&gt;</code> æ›¿æ¢ä¸ºå®é™…çš„ VHDX æ–‡ä»¶è·¯å¾„ï¼Œå¹¶å°† <code>&lt;NewSize&gt;</code> æ›¿æ¢ä¸ºæ‚¨è¦æ‰©å±•åˆ°çš„æ–°å¤§å°ï¼ˆä»¥ GB ä¸ºå•ä½ï¼‰ã€‚</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Resize-VHD</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -Path</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">YourPat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">h&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">xt4.vhdx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -SizeBytes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">NewSiz</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">GB</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ä¾‹å¦‚ï¼Œå¦‚æœ VHDX æ–‡ä»¶ä½äº <code>C:\Users\example\AppData\Local\Packages\CanonicalGroupLimited.Ubuntu18.04onWindows_79rhkp1fndgsc\LocalState\ext4.vhdx</code>ï¼Œå¹¶ä¸”æ‚¨å¸Œæœ›å°†å…¶æ‰©å±•åˆ° 50GBï¼Œåˆ™åº”è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Resize-VHD</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -Path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;C:\Users\example\AppData\Local\Packages\CanonicalGroupLimited.Ubuntu18.04onWindows_79rhkp1fndgsc\LocalState\ext4.vhdx&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -SizeBytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 50GB</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>æ­¥éª¤ 4</strong>ï¼šå¯åŠ¨ WSL2 å®ä¾‹ã€‚åœ¨ Windows PowerShell æˆ–å‘½ä»¤æç¤ºç¬¦ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wsl</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>æ­¥éª¤ 5</strong>ï¼šç°åœ¨ï¼Œæ‚¨éœ€è¦åœ¨ WSL2 Ubuntu 18.04 å†…éƒ¨è°ƒæ•´æ–‡ä»¶ç³»ç»Ÿã€‚è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå°† <code>&lt;NewSize&gt;</code> æ›¿æ¢ä¸ºå®é™…çš„æ–°å¤§å°ï¼ˆä»¥ GB ä¸ºå•ä½ï¼‰ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> resize2fs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/sda</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">NewSiz</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">G</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨å°† VHDX æ–‡ä»¶æ‰©å±•åˆ° 50GBï¼Œåˆ™åº”è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> resize2fs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/sda</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 50G</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å®Œæˆè¿™äº›æ­¥éª¤åï¼ŒWSL2 Ubuntu 18.04 çš„ç£ç›˜å®¹é‡åº”å·²æˆåŠŸæ‰©å±•ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ <code>df -h</code> å‘½ä»¤æ£€æŸ¥æ–°çš„ç£ç›˜ç©ºé—´ã€‚</p><h2 id="wls2-install-android-studio-clion" tabindex="-1"><a class="header-anchor" href="#wls2-install-android-studio-clion"><span>wls2 install android-studio &amp;&amp; clion</span></a></h2><p><a href="https://learn.microsoft.com/zh-cn/windows/wsl/tutorials/gui-apps" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/zh-cn/windows/wsl/tutorials/gui-apps</a></p><h2 id="aosp-install-repo" tabindex="-1"><a class="header-anchor" href="#aosp-install-repo"><span>aosp install repo</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> update</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> repo</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> upgrade</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> repo</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .repo/repo/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pull</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /home/biezhihua/projects/aosp/.repo/repo/repo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/bin/repo</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a+rx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/bin/repo</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">repo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sync</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -c</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -j8</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><a href="https://source.android.com/docs/setup/download" target="_blank" rel="noopener noreferrer">https://source.android.com/docs/setup/download</a></li><li><a href="https://gerrit.googlesource.com/git-repo/+/refs/heads/master/README.md" target="_blank" rel="noopener noreferrer">https://gerrit.googlesource.com/git-repo/+/refs/heads/master/README.md</a></li></ul><h2 id="aosp-simple-download-and-build" tabindex="-1"><a class="header-anchor" href="#aosp-simple-download-and-build"><span>aosp simple download and build</span></a></h2><p>è¦ä¸‹è½½AOSPï¼ˆAndroid Open Source Projectï¼‰ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p><ol><li><p>å®‰è£…Gitï¼šè¦ä»AOSPä»£ç ä»“åº“ä¸­ä¸‹è½½æºä»£ç ï¼Œæ‚¨éœ€è¦å…ˆåœ¨è®¡ç®—æœºä¸Šå®‰è£…Gitã€‚æ‚¨å¯ä»¥ä»Gitå®˜ç½‘ä¸‹è½½å®‰è£…ç¨‹åºå¹¶æŒ‰ç…§è¯´æ˜è¿›è¡Œå®‰è£…ã€‚</p></li><li><p>è·å–AOSPä»£ç ï¼šæ‰“å¼€ç»ˆç«¯æˆ–å‘½ä»¤è¡Œçª—å£ï¼Œåœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œä»¥ä¸‹è½½AOSPä»£ç ï¼š</p></li></ol><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> aosp</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> aosp</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">repo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> init</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -u</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://android.googlesource.com/platform/manifest</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -b</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">branc</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">h&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">repo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sync</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…¶ä¸­ï¼Œ<code>&lt;branch&gt;</code> è¡¨ç¤ºæ‚¨è¦ä¸‹è½½çš„AOSPç‰ˆæœ¬çš„åˆ†æ”¯åç§°ã€‚ä¾‹å¦‚ï¼Œè¦ä¸‹è½½Android 12ï¼ˆä»£ç åç§°ä¸ºSï¼‰ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">repo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> init</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -u</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://android.googlesource.com/platform/manifest</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -b</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> android-12.0.0_r1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æ­¤å‘½ä»¤å°†åˆå§‹åŒ–repoå·¥å…·ï¼Œå¹¶ä½¿ç”¨æŒ‡å®šçš„åˆ†æ”¯ä»AOSPä»£ç ä»“åº“ä¸­è·å–æºä»£ç ã€‚ç„¶åï¼Œä½¿ç”¨ <code>repo sync</code> å‘½ä»¤å°†æ‰€æœ‰æºä»£ç ä¸‹è½½åˆ°æœ¬åœ°è®¡ç®—æœºä¸Šã€‚</p><ol start="3"><li>æ„å»ºAOSPï¼šä¸‹è½½å®ŒAOSPæºä»£ç åï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ„å»ºAOSPï¼š</li></ol><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">source</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> build/envsetup.sh</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lunch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -j4</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…¶ä¸­ï¼Œ<code>source build/envsetup.sh</code> å‘½ä»¤å°†è®¾ç½®å¿…è¦çš„ç¯å¢ƒå˜é‡ï¼Œ<code>lunch</code> å‘½ä»¤å°†æç¤ºæ‚¨é€‰æ‹©è¦æ„å»ºçš„ç›®æ ‡è®¾å¤‡ç±»å‹å’Œç‰ˆæœ¬ï¼Œè€Œ <code>make -j4</code> å‘½ä»¤å°†å¼€å§‹æ„å»ºè¿‡ç¨‹ã€‚è¯·æ³¨æ„ï¼Œè¿™ä¸ªè¿‡ç¨‹å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´å’Œå¤§é‡çš„ç£ç›˜ç©ºé—´ã€‚</p><ul><li><a href="https://mirrors.tuna.tsinghua.edu.cn/help/AOSP/" target="_blank" rel="noopener noreferrer">https://mirrors.tuna.tsinghua.edu.cn/help/AOSP/</a></li><li><a href="https://juejin.cn/post/7038543675109933070" target="_blank" rel="noopener noreferrer">https://juejin.cn/post/7038543675109933070</a></li></ul><h2 id="aosp-checkout-branch" tabindex="-1"><a class="header-anchor" href="#aosp-checkout-branch"><span>aosp checkout branch</span></a></h2><p>åˆ‡æ¢åˆ†æ”¯éœ€è¦å…ˆè¿›å…¥åˆ°ä½ æœ¬åœ°çš„AOSPä»£ç ç›®å½•ä¸­ï¼Œç„¶åä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">repo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> init</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -b</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">branch-nam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">repo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sync</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>å…¶ä¸­<code>&lt;branch-name&gt;</code>æŒ‡å®šä½ è¦åˆ‡æ¢åˆ°çš„åˆ†æ”¯åï¼Œä¾‹å¦‚åˆ‡æ¢åˆ°Android 13çš„åˆ†æ”¯ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">repo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> init</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -b</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> android-13.0.0_r41</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">repo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sync</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œå®Œä»¥ä¸Šå‘½ä»¤åï¼ŒAOSPä»£ç å°±ä¼šè¢«åŒæ­¥åˆ°å¯¹åº”çš„åˆ†æ”¯ã€‚æ³¨æ„ï¼Œåˆ‡æ¢åˆ†æ”¯å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›ä»£ç åº“çš„ç‰ˆæœ¬å˜åŒ–ï¼Œéœ€è¦è°¨æ…æ“ä½œã€‚</p><h2 id="repo-clean-all-unsaved-files" tabindex="-1"><a class="header-anchor" href="#repo-clean-all-unsaved-files"><span>repo clean all unsaved files</span></a></h2><p>Repoå·¥å…·æ˜¯Gitå·¥å…·çš„æ‰©å±•ï¼Œç”¨äºç®¡ç†å¤šä¸ªGitä»£ç ä»“åº“ã€‚ä¸Gitç±»ä¼¼ï¼ŒRepoä¹Ÿä¸ä¼šåœ¨æœ¬åœ°ä»“åº“ä¸­ä¿å­˜æœªæäº¤çš„æ›´æ”¹ã€‚å› æ­¤ï¼Œæ‚¨éœ€è¦ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æˆ–å…¶ä»–é€‚å½“çš„å·¥å…·æ¥ä¿å­˜æ‚¨çš„æ›´æ”¹ã€‚å¦‚æœæ‚¨å·²ç»å¯¹æŸäº›æ–‡ä»¶è¿›è¡Œäº†æ›´æ”¹ï¼Œä½†è¿˜æ²¡æœ‰æäº¤å®ƒä»¬ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æ¥æ¸…é™¤è¿™äº›æ›´æ”¹ï¼š</p><ol><li>å¦‚æœæ‚¨åªæƒ³æ¸…é™¤å•ä¸ªGitä»“åº“ä¸­çš„æ–‡ä»¶æ›´æ”¹ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</li></ol><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">repo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> forall</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">projec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt; </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">-c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;git checkout -- file-name&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å…¶ä¸­ <code>&lt;project&gt;</code> æ˜¯æ‚¨è¦æ¸…é™¤æ›´æ”¹çš„Gitä»“åº“çš„åç§°ï¼Œ<code>file-name</code> æ˜¯è¦æ¸…é™¤æ›´æ”¹çš„æ–‡ä»¶åã€‚è¯¥å‘½ä»¤å°†è¦†ç›–æœ¬åœ°çš„æ›´æ”¹ï¼Œå¹¶è¿˜åŸæ–‡ä»¶ä¸ºæœ€åä¸€æ¬¡æäº¤çš„çŠ¶æ€ã€‚</p><ol start="2"><li>å¦‚æœæ‚¨æƒ³æ¸…é™¤æ‰€æœ‰Gitä»“åº“ä¸­çš„æœªæäº¤æ›´æ”¹ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</li></ol><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">repo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> forall</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;git reset --hard&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¯¥å‘½ä»¤å°†é‡ç½®æ‰€æœ‰Gitä»“åº“çš„æœ¬åœ°ä»“åº“åˆ°æœ€åä¸€æ¬¡æäº¤çš„çŠ¶æ€ï¼Œå¹¶æ¸…é™¤æ‰€æœ‰æœªæäº¤çš„æ›´æ”¹ã€‚è¯·æ³¨æ„ï¼Œè¿™å°†ä¸å¯é€†åœ°åˆ é™¤æ‰€æœ‰æœªæäº¤çš„æ›´æ”¹ï¼Œå› æ­¤è¯·è°¨æ…ä½¿ç”¨ã€‚</p><p>æ— è®ºæ‚¨ä½¿ç”¨å“ªç§æ–¹æ³•ï¼Œéƒ½è¦ç¡®ä¿åœ¨æ¸…é™¤æ›´æ”¹ä¹‹å‰ï¼Œå°†é‡è¦çš„æ›´æ”¹ä¿å­˜åˆ°å…¶ä»–æ–‡ä»¶æˆ–å¤‡ä»½ä¸­ã€‚</p><h2 id="replace-source" tabindex="-1"><a class="header-anchor" href="#replace-source"><span>replace source</span></a></h2><p>å¦‚æœä½ ä¹‹å‰å·²ç»é€šè¿‡æŸç§é€”å¾„è·å¾—äº† AOSP çš„æºç (æˆ–è€…ä½ åªæ˜¯ init è¿™ä¸€æ­¥å®Œæˆå)ï¼Œ ä½ å¸Œæœ›ä»¥åé€šè¿‡ TUNA åŒæ­¥ AOSP éƒ¨åˆ†çš„ä»£ç ï¼Œåªéœ€è¦ä¿®æ”¹ .repo/manifests.git/configï¼Œå°†</p><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>url = https://android.googlesource.com/platform/manifest</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æ›´æ”¹ä¸º</p><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>url = https://mirrors.tuna.tsinghua.edu.cn/git/AOSP/platform/manifest</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æˆ–è€…å¯ä»¥ä¸ä¿®æ”¹æ–‡ä»¶ï¼Œè€Œæ‰§è¡Œ</p><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>git config --global url.https://mirrors.tuna.tsinghua.edu.cn/git/AOSP/.insteadof https://android.googlesource.com</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><a href="https://mirrors.tuna.tsinghua.edu.cn/help/AOSP/" target="_blank" rel="noopener noreferrer">https://mirrors.tuna.tsinghua.edu.cn/help/AOSP/</a></li></ul><h2 id="prepare-build-environment-of-wls2-ubuntu-18-04" tabindex="-1"><a class="header-anchor" href="#prepare-build-environment-of-wls2-ubuntu-18-04"><span>prepare build environment of wls2 - Ubuntu-18.04</span></a></h2><p><a href="https://source.android.com/docs/setup/start/initializing#installing-required-packages-ubuntu-1804" target="_blank" rel="noopener noreferrer">https://source.android.com/docs/setup/start/initializing#installing-required-packages-ubuntu-1804</a></p><h2 id="build-aosp" tabindex="-1"><a class="header-anchor" href="#build-aosp"><span>build aosp</span></a></h2><p>æŸ¥çœ‹CPUæ ¸å¿ƒæ•°é‡ï¼š</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;core id&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /proc/cpuinfo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sort</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -u</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -l</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><a href="https://juejin.cn/post/7043063280704684063" target="_blank" rel="noopener noreferrer">https://juejin.cn/post/7043063280704684063</a></li><li><a href="https://blog.csdn.net/nei504293736/article/details/109628378" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/nei504293736/article/details/109628378</a></li><li><a href="https://luyaoming.com/2021/06/23/wsl2%E4%B8%8B%E4%B8%8B%E8%BD%BD%E4%B8%8E%E7%BC%96%E8%AF%91AOSP/" target="_blank" rel="noopener noreferrer">https://luyaoming.com/2021/06/23/wsl2ä¸‹ä¸‹è½½ä¸ç¼–è¯‘AOSP/</a></li></ul><h2 id="wls2-set-the-fixed-ip-address-set-the-read-and-write-capability-of-the-smb-directory" tabindex="-1"><a class="header-anchor" href="#wls2-set-the-fixed-ip-address-set-the-read-and-write-capability-of-the-smb-directory"><span>wls2 set the fixed IP address &amp; set the read and write capability of the SMB directory</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[share]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   comment</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> share</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /home/biezhihua/projects/aosp</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   force</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> user</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   writeable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> yes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   browseable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> yes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   public</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> yes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   create</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mask</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0644</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   directory</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mask</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0755</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> smbd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><a href="https://zhuanlan.zhihu.com/p/380779630" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/380779630</a></li><li><a href="https://github.com/MicrosoftDocs/WSL/issues/418#issuecomment-648570865" target="_blank" rel="noopener noreferrer">https://github.com/MicrosoftDocs/WSL/issues/418#issuecomment-648570865</a></li><li><a href="https://blog.csdn.net/weixin_41301508/article/details/108939520" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/weixin_41301508/article/details/108939520</a></li><li><a href="https://unix.stackexchange.com/questions/206309/how-to-create-a-samba-share-that-is-writable-from-windows-without-777-permission" target="_blank" rel="noopener noreferrer">https://unix.stackexchange.com/questions/206309/how-to-create-a-samba-share-that-is-writable-from-windows-without-777-permission</a></li><li><a href="https://blog.csdn.net/sinat_21011081/article/details/118404717?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-118404717-blog-108939520.235%5Ev32%5Epc_relevant_default_base3&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-118404717-blog-108939520.235%5Ev32%5Epc_relevant_default_base3&amp;utm_relevant_index=1" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/sinat_21011081/article/details/118404717?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-118404717-blog-108939520.235^v32^pc_relevant_default_base3&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-118404717-blog-108939520.235^v32^pc_relevant_default_base3&amp;utm_relevant_index=1</a></li></ul><h2 id="run-a-compiled-image-to-emulator-method1" tabindex="-1"><a class="header-anchor" href="#run-a-compiled-image-to-emulator-method1"><span>run a compiled image to emulator | method1</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ“¦é™¤å·²æœ‰çš„avdæ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">D:\Android\sdk\emulator\emulator.exe</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -avd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> biezhihua_aosp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  -wipe-data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ¨¡æ‹Ÿå™¨é‡æ–°åŠ è½½android image</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">D:\Android\sdk\emulator\emulator.exe</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -avd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> biezhihua_aosp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  -system</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;your_android_path\out\target\product\generic_x86_64\system.img&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -data</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;your_android_path\out\target\product\generic_x86_64\userdata.img&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> D:\Android\sdk\emulator\emulator.exe</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -avd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> biezhihua_aosp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  -system</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">wsl.localhost\Ubuntu-18.04\home\biezhihua\projects\aosp\out\target\product\emulator_x86_64\system.img&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -data</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">wsl.localhost\Ubuntu-18.04\home\biezhihua\projects\aosp\out\target\product\emulator_x86_64\userdata.img&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><a href="https://blog.csdn.net/dangelzjj/article/details/109267411" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/dangelzjj/article/details/109267411</a></li><li><a href="https://blog.csdn.net/dangelzjj/article/details/109267411" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/dangelzjj/article/details/109267411</a></li><li><a href="https://blog.csdn.net/yongwn/article/details/121009506" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/yongwn/article/details/121009506</a></li><li><a href="https://groups.google.com/g/android-building/c/O9a6Ohnb5hI?pli=1" target="_blank" rel="noopener noreferrer">https://groups.google.com/g/android-building/c/O9a6Ohnb5hI?pli=1</a></li></ul><h2 id="run-a-compiled-image-to-emulator-method2" tabindex="-1"><a class="header-anchor" href="#run-a-compiled-image-to-emulator-method2"><span>run a compiled image to emulator | method2</span></a></h2><p>æ‹·è´äº§ç‰©åˆ°windowsé•œåƒç›®å½•ä¸‹ï¼›</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> out/target/product/emulator_x86_64/VerifiedBootParams.textproto</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/d/Android/sdk/system-images/android-33/google_apis/x86_64/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> out/target/product/emulator_x86_64/advancedFeatures.ini</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/d/Android/sdk/system-images/android-33/google_apis/x86_64/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> out/target/product/emulator_x86_64/encryptionkey.img</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/d/Android/sdk/system-images/android-33/google_apis/x86_64/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> out/target/product/emulator_x86_64/kernel-ranchu</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/d/Android/sdk/system-images/android-33/google_apis/x86_64/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> out/target/product/emulator_x86_64/ramdisk-qemu.img</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/d/Android/sdk/system-images/android-33/google_apis/x86_64/ramdisk.img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> out/target/product/emulator_x86_64/system-qemu.img</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/d/Android/sdk/system-images/android-33/google_apis/x86_64/system.img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> out/target/product/emulator_x86_64/userdata.img</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/d/Android/sdk/system-images/android-33/google_apis/x86_64/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> out/target/product/emulator_x86_64/vendor-qemu.img</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/d/Android/sdk/system-images/android-33/google_apis/x86_64/vendor.img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> out/target/product/emulator_x86_64/system/build.prop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/d/Android/sdk/system-images/android-33/google_apis/x86_64/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">emulator</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -avd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Pixel_3_Edited_API_30</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -writable-system</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -wipe-data</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -show-kernel</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -skip-adb-auth</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -no-cache</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">emulator.exe</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -avd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> biezhihua_aosp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  -system</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">wsl.localhost\Ubuntu-18.04\home\biezhihua\projects\aosp\out\target\product\emulator_x86_64\system-qemu.img&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -data</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">wsl.localhost\Ubuntu-18.04\home\biezhihua\projects\aosp\out\target\product\emulator_x86_64\userdata.img&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -writable-system</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -wipe-data</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -show-kernel</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -skip-adb-auth</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -no-cache</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">emulator.exe</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -avd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> biezhihua_aosp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  -system</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">wsl.localhost\Ubuntu-18.04\home\biezhihua\projects\aosp\out\target\product\emulator_x86_64\system-qemu.img&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -data</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">wsl.localhost\Ubuntu-18.04\home\biezhihua\projects\aosp\out\target\product\emulator_x86_64\userdata.img&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -writable-system</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -show-kernel</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -skip-adb-auth</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><a href="https://sidneyding.cn/posts/c64b5633/" target="_blank" rel="noopener noreferrer">https://sidneyding.cn/posts/c64b5633/</a></li></ul><h2 id="run-a-compiled-image-to-emulator-method3" tabindex="-1"><a class="header-anchor" href="#run-a-compiled-image-to-emulator-method3"><span>run a compiled image to emulator | method3</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">emulator</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -avd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> biezhihua_aosp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  -system</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;/home/biezhihua/projects/aosp/out/target/product/emulator_x86_64/system-qemu.img&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -data</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;/home/biezhihua/projects/aosp/out/target/product/emulator_x86_64/userdata.img&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -writable-system</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -show-kernel</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -skip-adb-auth</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -wipe-data</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="å¯¹äºaosp-å¦‚ä½•æ‰“åŒ…å•ä¸ªæ¨¡å—å¹¶æ›´æ–°system-imgæ–‡ä»¶-è¯·ä»¥framework-nativeä¸ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å¯¹äºaosp-å¦‚ä½•æ‰“åŒ…å•ä¸ªæ¨¡å—å¹¶æ›´æ–°system-imgæ–‡ä»¶-è¯·ä»¥framework-nativeä¸ºä¾‹"><span>å¯¹äºAOSPï¼Œå¦‚ä½•æ‰“åŒ…å•ä¸ªæ¨¡å—å¹¶æ›´æ–°system.imgæ–‡ä»¶ï¼Œè¯·ä»¥framework/nativeä¸ºä¾‹</span></a></h2><p>åœ¨ AOSP æºä»£ç ä¸­ï¼Œè‹¥è¦ä»…æ„å»º framework/native æ¨¡å—å¹¶æ›´æ–° system.img æ–‡ä»¶ï¼Œå¯æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p><p><strong>æ­¥éª¤ 1</strong>ï¼šå¯åŠ¨ä¸€ä¸ªç»ˆç«¯å¹¶è¿›å…¥ AOSP æºä»£ç çš„æ ¹ç›®å½•ã€‚</p><p><strong>æ­¥éª¤ 2</strong>ï¼šå¯åŠ¨æ„å»ºç¯å¢ƒï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><p>bash</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">source</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> build/envsetup.sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>æ­¥éª¤ 3</strong>ï¼šé€‰æ‹©è¦æ„å»ºçš„ç›®æ ‡è®¾å¤‡ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¦ä¸º <code>sdk_phone_x86_64-eng</code> æ„å»ºæ¨¡å—ï¼Œè¯·è¿è¡Œï¼š</p><p>bash</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lunch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sdk_phone_x86_64-eng</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>æ­¥éª¤ 4</strong>ï¼šæ„å»º framework/native æ¨¡å—ã€‚<code>framework/native</code> å®é™…ä¸ŠåŒ…å«è®¸å¤šæ¨¡å—ã€‚å‡è®¾æ‚¨è¦æ„å»º <code>libui</code> æ¨¡å—ï¼Œå¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><p>bash</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mmm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -j$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nproc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">)</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> frameworks/native/libs/ui</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™å°†ä»…æ„å»º <code>libui</code> æ¨¡å—ã€‚è¦æ„å»ºæ•´ä¸ª <code>framework/native</code>ï¼Œæ‚¨éœ€è¦ä¸ºæ¯ä¸ªå­æ¨¡å—é‡å¤æ­¤æ­¥éª¤ã€‚</p><p><strong>æ­¥éª¤ 5</strong>ï¼šç°åœ¨ï¼Œå·²ç»æ„å»ºäº†æ‰€éœ€çš„æ¨¡å—ï¼Œéœ€è¦å°†å…¶å®‰è£…åˆ° system.img ä¸­ã€‚ä¸ºæ­¤ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><p>bash</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> snod</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æ­¤å‘½ä»¤å°†æ ¹æ®å·²ç»ç”Ÿæˆçš„å„ä¸ªåˆ†åŒºï¼ˆåŒ…æ‹¬å·²æ›´æ–°çš„æ¨¡å—ï¼‰é‡æ–°ç”Ÿæˆ system.img æ–‡ä»¶ã€‚</p><p>å®Œæˆä¸Šè¿°æ­¥éª¤åï¼Œæ‚¨å¯ä»¥åœ¨ <code>out/target/product/&lt;device&gt;/</code> ç›®å½•ä¸‹æ‰¾åˆ°æ›´æ–°åçš„ system.img æ–‡ä»¶ã€‚æ­¤æ—¶ï¼Œæ‚¨å¯ä»¥å°†æ›´æ–°åçš„ system.img åˆ·å…¥è®¾å¤‡æˆ–æ¨¡æ‹Ÿå™¨ä»¥è¿›è¡Œæµ‹è¯•ã€‚</p><p>æ³¨æ„ï¼šå¦‚æœæ‚¨çš„ç›®æ ‡æ˜¯å°†æ–°ç”Ÿæˆçš„æ¨¡å—ï¼ˆä¾‹å¦‚ .so æ–‡ä»¶ï¼‰æ¨é€åˆ°å·²è¿è¡Œçš„è®¾å¤‡æˆ–æ¨¡æ‹Ÿå™¨ä¸Šï¼Œé‚£ä¹ˆåœ¨æ­¥éª¤ 4 ä¹‹åï¼Œæ‚¨å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>adb push</code> å‘½ä»¤å°†æ–°ç”Ÿæˆçš„æ¨¡å—æ¨é€åˆ°ç›¸åº”çš„ç›®å½•ï¼Œè€Œæ— éœ€é‡æ–°ç”Ÿæˆæ•´ä¸ª system.imgã€‚ä¾‹å¦‚ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">adb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">adb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> remount</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">adb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> out/target/product/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">devic</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/system/lib64/libui.so</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /system/lib64/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">adb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sync</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">adb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reboot</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·å°† <code>&lt;device&gt;</code> æ›¿æ¢ä¸ºå®é™…çš„è®¾å¤‡åç§°ã€‚è¿™å°†åœ¨é‡æ–°å¯åŠ¨è®¾å¤‡åç«‹å³åº”ç”¨æ–°çš„æ¨¡å—ã€‚</p><h2 id="å¯¹äºaosp-å¦‚ä½•æ‰“åŒ…å•ä¸ªæ¨¡å—å¹¶æ›´æ–°system-imgæ–‡ä»¶-è¯·ä»¥framework-native-surfaceflingerä¸ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å¯¹äºaosp-å¦‚ä½•æ‰“åŒ…å•ä¸ªæ¨¡å—å¹¶æ›´æ–°system-imgæ–‡ä»¶-è¯·ä»¥framework-native-surfaceflingerä¸ºä¾‹"><span>å¯¹äºAOSPï¼Œå¦‚ä½•æ‰“åŒ…å•ä¸ªæ¨¡å—å¹¶æ›´æ–°system.imgæ–‡ä»¶ï¼Œè¯·ä»¥framework/native/surfaceflingerä¸ºä¾‹</span></a></h2><p>åœ¨ AOSP æºä»£ç ä¸­ï¼Œè‹¥è¦ä»…æ„å»º framework/native/surfaceflinger æ¨¡å—å¹¶æ›´æ–° system.img æ–‡ä»¶ï¼Œå¯æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p><p><strong>æ­¥éª¤ 1</strong>ï¼šå¯åŠ¨ä¸€ä¸ªç»ˆç«¯å¹¶è¿›å…¥ AOSP æºä»£ç çš„æ ¹ç›®å½•ã€‚</p><p><strong>æ­¥éª¤ 2</strong>ï¼šå¯åŠ¨æ„å»ºç¯å¢ƒï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">source</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> build/envsetup.sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>æ­¥éª¤ 3</strong>ï¼šé€‰æ‹©è¦æ„å»ºçš„ç›®æ ‡è®¾å¤‡ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¦ä¸º <code>sdk_phone_x86_64-eng</code> æ„å»ºæ¨¡å—ï¼Œè¯·è¿è¡Œï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lunch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sdk_phone_x86_64-eng</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>æ­¥éª¤ 4</strong>ï¼šæ„å»º framework/native/surfaceflinger æ¨¡å—ã€‚è¦æ„å»º SurfaceFlinger æ¨¡å—ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mmm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -j$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nproc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">)</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> frameworks/native/services/surfaceflinger</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mmm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -j32</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> frameworks/native/services/surfaceflinger</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™å°†ä»…æ„å»º SurfaceFlinger æ¨¡å—ã€‚</p><p><strong>æ­¥éª¤ 5</strong>ï¼šç°åœ¨ï¼Œå·²ç»æ„å»ºäº†æ‰€éœ€çš„æ¨¡å—ï¼Œéœ€è¦å°†å…¶å®‰è£…åˆ° system.img ä¸­ã€‚ä¸ºæ­¤ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> snod</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æ­¤å‘½ä»¤å°†æ ¹æ®å·²ç»ç”Ÿæˆçš„å„ä¸ªåˆ†åŒºï¼ˆåŒ…æ‹¬å·²æ›´æ–°çš„æ¨¡å—ï¼‰é‡æ–°ç”Ÿæˆ system.img æ–‡ä»¶ã€‚</p><p>å®Œæˆä¸Šè¿°æ­¥éª¤åï¼Œæ‚¨å¯ä»¥åœ¨ <code>out/target/product/&lt;device&gt;/</code> ç›®å½•ä¸‹æ‰¾åˆ°æ›´æ–°åçš„ system.img æ–‡ä»¶ã€‚æ­¤æ—¶ï¼Œæ‚¨å¯ä»¥å°†æ›´æ–°åçš„ system.img åˆ·å…¥è®¾å¤‡æˆ–æ¨¡æ‹Ÿå™¨ä»¥è¿›è¡Œæµ‹è¯•ã€‚</p><p>æ³¨æ„ï¼šå¦‚æœæ‚¨çš„ç›®æ ‡æ˜¯å°†æ–°ç”Ÿæˆçš„æ¨¡å—ï¼ˆä¾‹å¦‚ .so æ–‡ä»¶ï¼‰æ¨é€åˆ°å·²è¿è¡Œçš„è®¾å¤‡æˆ–æ¨¡æ‹Ÿå™¨ä¸Šï¼Œé‚£ä¹ˆåœ¨æ­¥éª¤ 4 ä¹‹åï¼Œæ‚¨å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>adb push</code> å‘½ä»¤å°†æ–°ç”Ÿæˆçš„æ¨¡å—æ¨é€åˆ°ç›¸åº”çš„ç›®å½•ï¼Œè€Œæ— éœ€é‡æ–°ç”Ÿæˆæ•´ä¸ª system.imgã€‚ä¾‹å¦‚ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">adb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">adb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> remount</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">adb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> out/target/product/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">devic</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/system/lib64/libsurfaceflinger.so</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /system/lib64/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">adb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">wsl.localhost</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\U</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">buntu-18.04</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\h</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ome</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\b</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">iezhihua</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">rojects</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">osp</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ut</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\t</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">arget</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">roduct</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">mulator_x86_64</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ystem</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\b</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">in</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\N</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ativeSFDemo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /system/bin/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">adb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sync</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">adb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reboot</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·å°† <code>&lt;device&gt;</code> æ›¿æ¢ä¸ºå®é™…çš„è®¾å¤‡åç§°ã€‚è¿™å°†åœ¨é‡æ–°å¯åŠ¨è®¾å¤‡åç«‹å³åº”ç”¨æ–°çš„æ¨¡å—ã€‚</p><h2 id="error-createramdiskwithbootconfig-can-t-open-product-emulator-x86-64-initrd-for-writing" tabindex="-1"><a class="header-anchor" href="#error-createramdiskwithbootconfig-can-t-open-product-emulator-x86-64-initrd-for-writing"><span>ERROR | createRamdiskWithBootconfig: Can&#39;t open &#39;product\emulator_x86_64\initrd&#39; for writing</span></a></h2><p>è¿™ä¸ªé”™è¯¯æç¤ºçš„æ˜¯åœ¨åˆ›å»º ramdisk æ—¶å‡ºç°é—®é¢˜ï¼Œæ— æ³•æ‰“å¼€ &quot;product\emulator_x86_64\initrd&quot; æ–‡ä»¶è¿›è¡Œå†™å…¥ã€‚è¿™å¯èƒ½æ˜¯ç”±äºä»¥ä¸‹åŸå› ä¹‹ä¸€å¯¼è‡´çš„ï¼š</p><ol><li><p><strong>æ–‡ä»¶è·¯å¾„é”™è¯¯</strong>ï¼šè¯·ç¡®ä¿ &quot;product\emulator_x86_64\initrd&quot; æ–‡ä»¶çš„è·¯å¾„æ­£ç¡®ã€‚æ³¨æ„åœ¨ Windows ç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶è·¯å¾„ä¸­çš„åˆ†éš”ç¬¦åº”ä¸ºåæ–œæ ï¼ˆ<code>\</code>ï¼‰ï¼Œè€Œåœ¨ç±» Unix ç³»ç»Ÿï¼ˆå¦‚ Linux å’Œ macOSï¼‰ä¸­ï¼Œæ–‡ä»¶è·¯å¾„ä¸­çš„åˆ†éš”ç¬¦åº”ä¸ºæ­£æ–œæ ï¼ˆ<code>/</code>ï¼‰ã€‚æ ¹æ®æ‚¨ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿï¼Œæ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®ã€‚</p></li><li><p><strong>æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹æƒé™é—®é¢˜</strong>ï¼šç¡®ä¿æ‚¨å…·æœ‰è¶³å¤Ÿçš„æƒé™è®¿é—® &quot;product\emulator_x86_64\initrd&quot; æ–‡ä»¶ã€‚åœ¨ Unix ç±»ç³»ç»Ÿä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ <code>chmod</code> å’Œ <code>chown</code> å‘½ä»¤æ¥æ›´æ”¹æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„æƒé™ã€‚åœ¨ Windows ç³»ç»Ÿä¸­ï¼Œå¯ä»¥å³é”®å•å‡»æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼Œç„¶åé€‰æ‹© &quot;å±æ€§&quot;ï¼Œåœ¨ &quot;å®‰å…¨&quot; é€‰é¡¹å¡ä¸­æ›´æ”¹æƒé™ã€‚</p></li><li><p><strong>æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ä¸å­˜åœ¨</strong>ï¼šç¡®ä¿ &quot;product\emulator_x86_64&quot; æ–‡ä»¶å¤¹å­˜åœ¨ï¼Œå¹¶ä¸”å…¶ä¸­åŒ…å« &quot;initrd&quot; æ–‡ä»¶ã€‚å¦‚æœç¼ºå°‘è¯¥æ–‡ä»¶ï¼Œè¯·å°è¯•é‡æ–°æ„å»ºé¡¹ç›®ä»¥ç”Ÿæˆæ­£ç¡®çš„æ–‡ä»¶ã€‚</p></li><li><p><strong>ç£ç›˜ç©ºé—´ä¸è¶³</strong>ï¼šè¯·ç¡®ä¿æ‚¨çš„ç³»ç»Ÿä¸Šæœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´å¯ä¾›å†™å…¥ &quot;product\emulator_x86_64\initrd&quot; æ–‡ä»¶ã€‚å¦‚æœç£ç›˜ç©ºé—´ä¸è¶³ï¼Œè¯·æ¸…ç†ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œä»¥é‡Šæ”¾è¶³å¤Ÿçš„ç©ºé—´ã€‚</p></li></ol><p>æ£€æŸ¥ä»¥ä¸Šå„é¡¹ï¼Œå¹¶æ ¹æ®éœ€è¦è¿›è¡Œç›¸åº”çš„ä¿®å¤æ“ä½œã€‚è¿™åº”è¯¥æœ‰åŠ©äºè§£å†³åœ¨è¿è¡Œ AOSP è‡ªå·±ç¼–è¯‘çš„é•œåƒæ—¶å‡ºç°çš„é”™è¯¯ã€‚</p><h2 id="aospä¸­æ‰“å°å‡½æ•°è°ƒç”¨æ ˆ-åœ¨surfaceflinger" tabindex="-1"><a class="header-anchor" href="#aospä¸­æ‰“å°å‡½æ•°è°ƒç”¨æ ˆ-åœ¨surfaceflinger"><span>AOSPä¸­æ‰“å°å‡½æ•°è°ƒç”¨æ ˆï¼Œåœ¨surfaceflinger</span></a></h2><p>ä¸å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ„å»ºå•ä¸ªæ¨¡å—ï¼Œå› ä¸ºæ— æ³•æŒ‡å®šå·¥ç¨‹æ„å»ºæ¶æ„ï¼Œä¼šäº§ç”Ÿç¼–è¯‘é”™è¯¯ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mmm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> frameworks/native/services/surfaceflinger</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>ld.lld: error: undefined symbol: android::CallStack::CallStack()</span></span>
<span class="line"><span>ld.lld: error: undefined symbol: android::CallStack::update(int, int)</span></span>
<span class="line"><span>ld.lld: error: undefined symbol: android::CallStack::log(char const*, android_LogPriority, char const*) const</span></span>
<span class="line"><span>ld.lld: error: undefined symbol: android::CallStack::~CallStack()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><a href="https://www.cnblogs.com/roger-yu/p/15596840.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/roger-yu/p/15596840.html</a></li><li><a href="https://utzcoz.github.io/2020/04/29/Print-call-stack-in-AOSP-native-code.html" target="_blank" rel="noopener noreferrer">https://utzcoz.github.io/2020/04/29/Print-call-stack-in-AOSP-native-code.html</a></li><li><a href="https://blog.csdn.net/zhaojia92/article/details/97827285" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/zhaojia92/article/details/97827285</a></li></ul><h2 id="aosp-è¿‡æ»¤è°ƒç”¨æ ˆæ—¥å¿—" tabindex="-1"><a class="header-anchor" href="#aosp-è¿‡æ»¤è°ƒç”¨æ ˆæ—¥å¿—"><span>AOSP è¿‡æ»¤è°ƒç”¨æ ˆæ—¥å¿—</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">emulator.exe</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -avd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> biezhihua_aosp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  -system</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">wsl.localhost\Ubuntu-18.04\home\biezhihua\projects\aosp\out\target\product\emulator_x86_64\system-qemu.img&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -data</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">wsl.localhost\Ubuntu-18.04\home\biezhihua\projects\aosp\out\target\product\emulator_x86_64\userdata.img&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -writable-system</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -show-kernel</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -skip-adb-auth</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -wipe-data</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><code>onComposerHalHotplug</code>çš„è°ƒç”¨æ ˆï¼š</p><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>î¿ # adb logcat | findstr &quot;bzh&quot;</span></span>
<span class="line"><span>05-03 23:34:47.773   443   443 D bzh     : #00 pc 00000000001ec91c  /system/bin/surfaceflinger (android::SurfaceFlinger::onComposerHalHotplug(unsigned long, android::hardware::graphics::composer::V2_1::IComposerCallback::Connection)+524)</span></span>
<span class="line"><span>05-03 23:34:47.773   443   443 D bzh     : #01 pc 000000000017bd71  /system/bin/surfaceflinger (android::Hwc2::(anonymous namespace)::ComposerCallbackBridge::onHotplug(unsigned long, android::hardware::graphics::composer::V2_1::IComposerCallback::Connection)+17)</span></span>
<span class="line"><span>05-03 23:34:47.773   443   443 D bzh     : #02 pc 00000000000293ef  /system/lib64/android.hardware.graphics.composer@2.1.so (android::hardware::graphics::composer::V2_1::BnHwComposerCallback::_hidl_onHotplug(android::hidl::base::V1_0::BnHwBase*, android::hardware::Parcel const&amp;, android::hardware::Parcel*, std::__1::function&lt;void (android::hardware::Parcel&amp;)&gt;)+239)</span></span>
<span class="line"><span>05-03 23:34:47.773   443   443 D bzh     : #03 pc 000000000003859b  /system/lib64/android.hardware.graphics.composer@2.4.so (android::hardware::graphics::composer::V2_4::BnHwComposerCallback::onTransact(unsigned int, android::hardware::Parcel const&amp;, android::hardware::Parcel*, unsigned int, std::__1::function&lt;void (android::hardware::Parcel&amp;)&gt;)+603)</span></span>
<span class="line"><span>05-03 23:34:47.773   443   443 D bzh     : #04 pc 000000000009ad49  /system/lib64/libhidlbase.so (android::hardware::BHwBinder::transact(unsigned int, android::hardware::Parcel const&amp;, android::hardware::Parcel*, unsigned int, std::__1::function&lt;void (android::hardware::Parcel&amp;)&gt;)+137)</span></span>
<span class="line"><span>05-03 23:34:47.773   443   443 D bzh     : #05 pc 00000000000a035a  /system/lib64/libhidlbase.so (android::hardware::IPCThreadState::executeCommand(int)+3770)</span></span>
<span class="line"><span>05-03 23:34:47.773   443   443 D bzh     : #06 pc 00000000000a11a7  /system/lib64/libhidlbase.so (android::hardware::IPCThreadState::waitForResponse(android::hardware::Parcel*, int*)+103)</span></span>
<span class="line"><span>05-03 23:34:47.774   443   443 D bzh     : #07 pc 00000000000a0ceb  /system/lib64/libhidlbase.so (android::hardware::IPCThreadState::transact(int, unsigned int, android::hardware::Parcel const&amp;, android::hardware::Parcel*, unsigned int)+171)</span></span>
<span class="line"><span>05-03 23:34:47.774   443   443 D bzh     : #08 pc 000000000009bc95  /system/lib64/libhidlbase.so (android::hardware::BpHwBinder::transact(unsigned int, android::hardware::Parcel const&amp;, android::hardware::Parcel*, unsigned int, std::__1::function&lt;void (android::hardware::Parcel&amp;)&gt;)+69)</span></span>
<span class="line"><span>05-03 23:34:47.774   443   443 D bzh     : #09 pc 000000000003eb72  /system/lib64/android.hardware.graphics.composer@2.4.so (android::hardware::graphics::composer::V2_4::BpHwComposerClient::_hidl_registerCallback_2_4(android::hardware::IInterface*, android::hardware::details::HidlInstrumentor*, android::sp&lt;android::hardware::graphics::composer::V2_4::IComposerCallback&gt; const&amp;)+514)</span></span>
<span class="line"><span>05-03 23:34:47.774   443   443 D bzh     : #10 pc 0000000000043298  /system/lib64/android.hardware.graphics.composer@2.4.so (android::hardware::graphics::composer::V2_4::BpHwComposerClient::registerCallback_2_4(android::sp&lt;android::hardware::graphics::composer::V2_4::IComposerCallback&gt; const&amp;)+40)</span></span>
<span class="line"><span>05-03 23:34:47.774   443   443 D bzh     : #11 pc 0000000000175be5  /system/bin/surfaceflinger (android::Hwc2::HidlComposer::registerCallback(android::HWC2::ComposerCallback&amp;)+229)</span></span>
<span class="line"><span>05-03 23:34:47.774   443   443 D bzh     : #12 pc 0000000000183c24  /system/bin/surfaceflinger (android::impl::HWComposer::setCallback(android::HWC2::ComposerCallback&amp;)+4004)</span></span>
<span class="line"><span>05-03 23:34:47.774   443   443 D bzh     : #13 pc 00000000001e4ded  /system/bin/surfaceflinger (android::SurfaceFlinger::init()+877)</span></span>
<span class="line"><span>05-03 23:34:47.774   443   443 D bzh     : #14 pc 0000000000237994  /system/bin/surfaceflinger (main+1220)</span></span>
<span class="line"><span>05-03 23:34:47.774   443   443 D bzh     : #15 pc 0000000000050cc9  /apex/com.android.runtime/lib64/bionic/libc.so (__libc_init+89)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="aidegen-ideå¯¼å…¥aospæºç " tabindex="-1"><a class="header-anchor" href="#aidegen-ideå¯¼å…¥aospæºç "><span>AIDEGen IDEå¯¼å…¥AOSPæºç </span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">aidegen</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> frameworks/native/services/surfaceflinger</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> c</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">aidegen</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> frameworks/native/services/surfaceflinger</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> c</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><a href="https://zhuanlan.zhihu.com/p/272522594" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/272522594</a></li><li><a href="https://www.youtube.com/watch?v=XJ0dI2SYHIE" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=XJ0dI2SYHIE</a></li><li><a href="https://juejin.cn/post/7166061140298956836" target="_blank" rel="noopener noreferrer">https://juejin.cn/post/7166061140298956836</a></li><li><a href="https://android.googlesource.com/platform/tools/asuite/+/refs/heads/master/aidegen/README.md" target="_blank" rel="noopener noreferrer">https://android.googlesource.com/platform/tools/asuite/+/refs/heads/master/aidegen/README.md</a></li></ul><h2 id="clion-debug-android-native-code" tabindex="-1"><a class="header-anchor" href="#clion-debug-android-native-code"><span>CLion debug android native code</span></a></h2><h3 id="å®‰è£…lldb" tabindex="-1"><a class="header-anchor" href="#å®‰è£…lldb"><span>å®‰è£…LLDB</span></a></h3><ul><li><a href="https://blog.csdn.net/iamdy/article/details/111272854" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/iamdy/article/details/111272854</a></li><li><a href="https://source.android.google.cn/docs/core/tests/debug/gdb?hl=zh-cn" target="_blank" rel="noopener noreferrer">https://source.android.google.cn/docs/core/tests/debug/gdb?hl=zh-cn</a></li><li><a href="https://lldb.llvm.org/" target="_blank" rel="noopener noreferrer">https://lldb.llvm.org/</a></li><li><a href="https://www.jetbrains.com/help/clion/remote-debug.html" target="_blank" rel="noopener noreferrer">https://www.jetbrains.com/help/clion/remote-debug.html</a></li><li><a href="https://www.jianshu.com/p/76ae75688079" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/76ae75688079</a></li><li><a href="https://blog.csdn.net/qq_23542165/article/details/121275404" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/qq_23542165/article/details/121275404</a></li></ul><h3 id="lldb-for-android" tabindex="-1"><a class="header-anchor" href="#lldb-for-android"><span>LLDB FOR Android</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/root/Android/Sdk/ndk/25.2.9519653/toolchains/llvm/prebuilt/linux-x86_64/lib64/clang/14.0.7/lib/linux/x86_64/lldb-server</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">adb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lldb-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/local/tmp</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">emulator_x86_64:/data/local/tmp</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # chmod 775 ./lldb-server</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">emulator_x86_64:/data/local/tmp</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # ./lldb-server platform --listen &quot;*:1234&quot; --server</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">adb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lldb-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/local/tmp/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">adb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> shell</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/local/tmp</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chmod</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 755</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lldb-server</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">./lldb-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> p</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --server</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --listen</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> unix-abstract:///data/local/tmp/debug.sock</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lldb-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;version&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">platform</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> list</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # æŸ¥çœ‹lldbå¯ä»¥è¿æ¥çš„å¹³å°</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">platform</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> select</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> remote-android</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">platform</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> status</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # æŸ¥çœ‹å¹³å°çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">platform</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> connect</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> unix-abstract-connect:///data/local/tmp/debug.sock</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">./lldb-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> platform</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --listen</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;*:1234&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --server</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">platform</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> connect</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> connect://emulator-5554:1234</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><a href="https://stackoverflow.com/questions/53733781/how-do-i-use-lldb-to-debug-c-code-on-android-on-command-line" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/53733781/how-do-i-use-lldb-to-debug-c-code-on-android-on-command-line</a></li><li><a href="https://youtrack.jetbrains.com/issue/CPP-26922" target="_blank" rel="noopener noreferrer">https://youtrack.jetbrains.com/issue/CPP-26922</a></li><li><a href="https://www.lili.kim/2019/01/28/android/Debug%20Android%20Native%20with%20LLDB/" target="_blank" rel="noopener noreferrer">https://www.lili.kim/2019/01/28/android/Debug Android Native with LLDB/</a></li></ul><h3 id="lldb-vs-code-debug-android-native-code" tabindex="-1"><a class="header-anchor" href="#lldb-vs-code-debug-android-native-code"><span>LLDB VS Code debug android native code</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">aidegen</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> frameworks/native/services</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> v</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/d/App/Microsoft</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">VS</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Code/bin</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><a href="https://github.com/xxr0ss/vscode_lldb_remote_android" target="_blank" rel="noopener noreferrer">https://github.com/xxr0ss/vscode_lldb_remote_android</a></li></ul><h2 id="gdb-clion-debug-android-native-code" tabindex="-1"><a class="header-anchor" href="#gdb-clion-debug-android-native-code"><span>GDB Clion debug android native code</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">adb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pidof</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> surfaceflinger</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">./gdbserver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> :12345</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --attach</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 460</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><a href="https://www.jetbrains.com/help/clion/remote-debug.html" target="_blank" rel="noopener noreferrer">https://www.jetbrains.com/help/clion/remote-debug.html</a></li></ul><h3 id="android-emulator-æ€ä¹ˆå¼€å¯-gdbserver" tabindex="-1"><a class="header-anchor" href="#android-emulator-æ€ä¹ˆå¼€å¯-gdbserver"><span>android emulator æ€ä¹ˆå¼€å¯ gdbserver</span></a></h3><p>æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤åœ¨ Android æ¨¡æ‹Ÿå™¨ä¸Šå¯åŠ¨ gdbserverï¼š</p><ol><li>åœ¨æ¨¡æ‹Ÿå™¨ä¸­å®‰è£… gdbserver</li></ol><p>é¦–å…ˆï¼Œæ‚¨éœ€è¦åœ¨æ¨¡æ‹Ÿå™¨ä¸­å®‰è£… gdbserverã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ adb å‘½ä»¤å®‰è£…ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>adb push gdbserver /data/local/tmp/</span></span>
<span class="line"><span>adb shell chmod 755 /data/local/tmp/gdbserver</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>åœ¨æ¨¡æ‹Ÿå™¨ä¸­å¯åŠ¨ gdbserver</li></ol><p>æ¥ä¸‹æ¥ï¼Œæ‚¨éœ€è¦åœ¨æ¨¡æ‹Ÿå™¨ä¸­å¯åŠ¨ gdbserverï¼Œä»¥ä¾¿å¯ä»¥é€šè¿‡ GDB è¿æ¥åˆ°å®ƒã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ adb å‘½ä»¤å¯åŠ¨ gdbserverï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>adb shell /data/local/tmp/gdbserver :&lt;port&gt; &lt;process-id&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å…¶ä¸­ <code>&lt;port&gt;</code> æ˜¯æ‚¨è¦ä½¿ç”¨çš„è°ƒè¯•ç«¯å£å·ï¼Œ<code>&lt;process-id&gt;</code> æ˜¯æ‚¨è¦è°ƒè¯•çš„è¿›ç¨‹ IDã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹å‘½ä»¤å°†å¯åŠ¨ gdbserver å¹¶å°†å…¶ç»‘å®šåˆ°ç«¯å£å· 1234ï¼Œä»¥è°ƒè¯•è¿›ç¨‹ ID 12345ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>adb shell /data/local/tmp/gdbserver :1234 12345</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="3"><li>åœ¨ä¸»æœºä¸Šè¿æ¥åˆ° gdbserver</li></ol><p>æœ€åï¼Œæ‚¨éœ€è¦åœ¨ä¸»æœºä¸Šè¿è¡Œ GDBï¼Œå¹¶ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿æ¥åˆ°æ¨¡æ‹Ÿå™¨ä¸­çš„ gdbserverï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>gdb &lt;executable&gt; -ex &#39;target remote &lt;ip-address&gt;:&lt;port&gt;&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å…¶ä¸­ <code>&lt;executable&gt;</code> æ˜¯æ‚¨è¦è°ƒè¯•çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œ<code>&lt;ip-address&gt;</code> æ˜¯æ‚¨çš„æ¨¡æ‹Ÿå™¨ IP åœ°å€ï¼Œ<code>&lt;port&gt;</code> æ˜¯æ‚¨åœ¨ç¬¬ 2 æ­¥ä¸­æŒ‡å®šçš„ç«¯å£å·ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹å‘½ä»¤å°†ä½¿ç”¨ GDB è¿æ¥åˆ° IP åœ°å€ä¸º 192.168.0.2ï¼Œç«¯å£å·ä¸º 1234 çš„æ¨¡æ‹Ÿå™¨ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>gdb my_app -ex &#39;target remote 192.168.0.2:1234&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¯·æ³¨æ„ï¼Œåœ¨è¿æ¥åˆ°æ¨¡æ‹Ÿå™¨ä¹‹å‰ï¼Œæ‚¨éœ€è¦ç¡®ä¿æ¨¡æ‹Ÿå™¨å’Œä¸»æœºåœ¨åŒä¸€ç½‘ç»œä¸­ï¼Œå¹¶ä¸”å¯ä»¥ç›¸äº’é€šä¿¡ã€‚</p><p>å¸Œæœ›è¿™å¯ä»¥å¸®åŠ©æ‚¨å¯åŠ¨ gdbserver å¹¶è¿æ¥åˆ° Android æ¨¡æ‹Ÿå™¨è¿›è¡Œè°ƒè¯•ã€‚</p><h3 id="androidå¯ç”¨çš„gdbserveråœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°" tabindex="-1"><a class="header-anchor" href="#androidå¯ç”¨çš„gdbserveråœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°"><span>androidå¯ç”¨çš„gdbserveråœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°</span></a></h3><p>å¯ä»¥åœ¨ Android NDK ä¸­æ‰¾åˆ°å¯ç”¨çš„ gdbserverã€‚å¯ä»¥ä»ä»¥ä¸‹ä½ç½®ä¸‹è½½ Android NDKï¼š<a href="https://developer.android.com/ndk/downloads%E3%80%82" target="_blank" rel="noopener noreferrer">https://developer.android.com/ndk/downloadsã€‚</a></p><p>åœ¨ä¸‹è½½å¹¶è§£å‹ç¼© Android NDK åï¼Œæ‚¨å¯ä»¥åœ¨ <code>&lt;ndk_root&gt;/prebuilt/android-x86/gdbserver</code>ï¼ˆæˆ–å…¶ä»– CPU æ¶æ„çš„ç›¸åº”ç›®å½•ï¼‰æ‰¾åˆ° gdbserver å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p><p>å°†æ­¤å¯æ‰§è¡Œæ–‡ä»¶å¤åˆ¶åˆ° Android è®¾å¤‡ä¸Šï¼Œå¹¶åœ¨è®¾å¤‡ä¸Šè¿è¡Œå®ƒä»¥å¯åŠ¨ gdbserverã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„ Android è®¾å¤‡çš„ IP åœ°å€ä¸º <code>192.168.1.100</code>ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ gdbserverï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>adb shell /data/local/tmp/gdbserver :9999 --attach &lt;pid&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™å°†åœ¨ Android è®¾å¤‡ä¸Šçš„ <code>9999</code> ç«¯å£ä¸Šå¯åŠ¨ gdbserverï¼Œå¹¶å°†å…¶é™„åŠ åˆ° <code>&lt;pid&gt;</code> æŒ‡å®šçš„è¿›ç¨‹ã€‚ç„¶åï¼Œæ‚¨å¯ä»¥åœ¨æœ¬åœ°ä¸»æœºä¸Šä½¿ç”¨ gdb æ¥è¿æ¥ gdbserver å¹¶è¿›è¡Œè°ƒè¯•ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>gdb</span></span>
<span class="line"><span>(gdb) target remote 192.168.1.100:9999</span></span>
<span class="line"><span>(gdb) ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼Œå¦‚æœæ‚¨çš„ Android è®¾å¤‡å·²ç» rootï¼Œå¹¶ä¸”å·²ç»å®‰è£…äº† SuperSU æˆ– Magisk ç­‰ root ç®¡ç†åº”ç”¨ç¨‹åºï¼Œåˆ™å¯ä»¥ç›´æ¥å°† gdbserver å®‰è£…åˆ°è®¾å¤‡ä¸Šï¼Œè€Œä¸éœ€è¦æ¯æ¬¡éƒ½å¤åˆ¶å®ƒã€‚</p><h2 id="clioné¢„è§ˆä»£ç -lldbè°ƒè¯•ä»£ç " tabindex="-1"><a class="header-anchor" href="#clioné¢„è§ˆä»£ç -lldbè°ƒè¯•ä»£ç "><span>CLioné¢„è§ˆä»£ç ï¼ŒLLDBè°ƒè¯•ä»£ç </span></a></h2><p>é¢„è§ˆä»£ç </p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">aidegen</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> frameworks</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> c</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å¯åŠ¨æ¨¡æ‹Ÿå™¨</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>emulator -avd biezhihua_aosp  -system &quot;/home/biezhihua/projects/aosp/out/target/product/emulator_x86_64/system-qemu.img&quot; -data &quot;/home/biezhihua/projects/aosp/out/target/product/emulator_x86_64/userdata.img&quot; -writable-system -show-kernel -skip-adb-auth -wipe-data</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è·å–ç›®æ ‡è¿›ç¨‹PID</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>adb shell pidof surfaceflinger</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è°ƒè¯•ä»£ç </p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">//</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> è¿›å…¥è°ƒè¯•æ¨¡å¼</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lldbclient.py</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 446</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">//</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> é¦–æ¬¡è¿›å…¥åï¼Œæ‰€æœ‰çº¿ç¨‹ä¼šå› ä¸ºstop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reason</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> signal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SIGSTOPæŒ‚èµ·</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">continue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> è®©è¿›ç¨‹ç»§ç»­æ‰§è¡Œ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¢åŠ æ–­ç‚¹ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">breakpoint</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> set</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SurfaceFlinger::onComposerHalVsync</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æ‰“å°è°ƒç”¨æ ˆ</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">bt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><a href="https://source.android.com/docs/core/tests/debug/gdb?hl=zh-cn" target="_blank" rel="noopener noreferrer">https://source.android.com/docs/core/tests/debug/gdb?hl=zh-cn</a></li><li><a href="https://lldb.llvm.org/" target="_blank" rel="noopener noreferrer">https://lldb.llvm.org/</a></li></ul><h2 id="init-got-an-unexpected-keyword-argument-text" tabindex="-1"><a class="header-anchor" href="#init-got-an-unexpected-keyword-argument-text"><span><strong>init</strong>() got an unexpected keyword argument &#39;text&#39;</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>âœ  aosp lldbclient.py -p 3696  --setup-forwarding vscode-lldb</span></span>
<span class="line"><span>Traceback (most recent call last):</span></span>
<span class="line"><span>  File &quot;/home/biezhihua/projects/aosp/development/scripts/lldbclient.py&quot;, line 426, in &lt;module&gt;</span></span>
<span class="line"><span>    main()</span></span>
<span class="line"><span>  File &quot;/home/biezhihua/projects/aosp/development/scripts/lldbclient.py&quot;, line 418, in main</span></span>
<span class="line"><span>    do_main()</span></span>
<span class="line"><span>  File &quot;/home/biezhihua/projects/aosp/development/scripts/lldbclient.py&quot;, line 352, in do_main</span></span>
<span class="line"><span>    clang_version = read_toolchain_config(root)</span></span>
<span class="line"><span>  File &quot;/home/biezhihua/projects/aosp/development/scripts/lldbclient.py&quot;, line 41, in read_toolchain_config</span></span>
<span class="line"><span>    text=True)</span></span>
<span class="line"><span>  File &quot;/usr/lib/python3.6/subprocess.py&quot;, line 356, in check_output</span></span>
<span class="line"><span>    **kwargs).stdout</span></span>
<span class="line"><span>  File &quot;/usr/lib/python3.6/subprocess.py&quot;, line 423, in run</span></span>
<span class="line"><span>    with Popen(*popenargs, **kwargs) as process:</span></span>
<span class="line"><span>TypeError: **init**() got an unexpected keyword argument &#39;text&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªé”™è¯¯å‘ç”Ÿåœ¨è¿è¡Œ <code>lldbclient.py</code> è„šæœ¬æ—¶ã€‚åŸå› æ˜¯åœ¨æ‚¨ä½¿ç”¨çš„ Python ç‰ˆæœ¬ï¼ˆ3.6ï¼‰ä¸­ï¼Œ<code>subprocess</code> æ¨¡å—çš„ <code>Popen</code> ç±»çš„ <code>__init__()</code> æ–¹æ³•ä¸æ”¯æŒ <code>text</code> å…³é”®å­—å‚æ•°ã€‚<code>text</code> å‚æ•°åœ¨ Python 3.7 åŠæ›´é«˜ç‰ˆæœ¬çš„ <code>subprocess</code> æ¨¡å—ä¸­å¼•å…¥ï¼Œç”¨äºæ›¿ä»£è¿‡æ—¶çš„ <code>universal_newlines</code> å‚æ•°ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ‚¨å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ol><li><p>æ›´æ–° Python ç‰ˆæœ¬ã€‚å»ºè®®å®‰è£… Python 3.7 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨æ‚¨çš„åŒ…ç®¡ç†å™¨æˆ–ä» <a href="https://www.python.org/downloads/" target="_blank" rel="noopener noreferrer">Python å®˜æ–¹ç½‘ç«™</a> ä¸‹è½½å¹¶å®‰è£…æ–°ç‰ˆæœ¬æ¥å®Œæˆã€‚</p></li><li><p>å¦‚æœæ‚¨ä¸å¸Œæœ›æˆ–ä¸èƒ½æ›´æ–° Pythonï¼Œå¯ä»¥å°è¯•ä¿®æ”¹ <code>lldbclient.py</code> è„šæœ¬ã€‚åœ¨è„šæœ¬çš„ç¬¬ 41 è¡Œï¼Œå°†ä»¥ä¸‹ä»£ç ï¼š</p></li></ol><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">text</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">True</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æ›¿æ¢ä¸ºï¼š</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">universal_newlines</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">True</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™ä¼šåœ¨æ—§ç‰ˆæœ¬çš„ <code>subprocess</code> æ¨¡å—ä¸­ä½¿ç”¨ <code>universal_newlines</code> å‚æ•°ï¼Œå®ç°ä¸ <code>text</code> å‚æ•°ç›¸åŒçš„åŠŸèƒ½ã€‚</p><p>ä¿å­˜æ›´æ”¹åï¼Œå†æ¬¡è¿è¡Œ <code>lldbclient.py</code> è„šæœ¬ï¼Œé—®é¢˜åº”è¯¥å¾—åˆ°è§£å†³ã€‚</p><h2 id="other" tabindex="-1"><a class="header-anchor" href="#other"><span>other</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">adb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -A</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> surfaceflinger</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></div><!----><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><span class="vp-meta-info" data-allow-mismatch="text">2025/3/8 14:25:34</span></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: biezhihua@gmail.com">biezhihua</span><!--]--><!--]--></div></div></footer><!----><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><!----><div class="vp-copyright">Copyright Â© 2025 åˆ«å¿—å </div></footer></div><!--]--><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/assets/app-D4ZtVCQo.js" defer></script>
  </body>
</html>
