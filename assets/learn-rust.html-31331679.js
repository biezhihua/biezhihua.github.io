import{_ as n,Y as s,Z as a,a2 as e}from"./framework-301d0703.js";const t={},p=e(`<h1 id="learn-rust" tabindex="-1"><a class="header-anchor" href="#learn-rust" aria-hidden="true">#</a> Learn | Rust</h1><h2 id="give-me-a-example-for-dyn-in-rust-language" tabindex="-1"><a class="header-anchor" href="#give-me-a-example-for-dyn-in-rust-language" aria-hidden="true">#</a> give me a example for dyn in Rust language.</h2><p>Certainly! Here&#39;s an example of using dynamic dispatch (<code>dyn</code>) in Rust:</p><div class="language-rust line-numbers-mode" data-ext="rs"><pre class="language-rust"><code><span class="token keyword">trait</span> <span class="token type-definition class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">speak</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">Dog</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">Cat</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Animal</span> <span class="token keyword">for</span> <span class="token class-name">Dog</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">speak</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;{} says: Woof!&quot;</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Animal</span> <span class="token keyword">for</span> <span class="token class-name">Cat</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">speak</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;{} says: Meow!&quot;</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> dog<span class="token punctuation">:</span> <span class="token class-name">Box</span><span class="token operator">&lt;</span><span class="token keyword">dyn</span> <span class="token class-name">Animal</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Dog</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;Buddy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> cat<span class="token punctuation">:</span> <span class="token class-name">Box</span><span class="token operator">&lt;</span><span class="token keyword">dyn</span> <span class="token class-name">Animal</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Cat</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;Whiskers&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    dog<span class="token punctuation">.</span><span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cat<span class="token punctuation">.</span><span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In this example, we define a trait called <code>Animal</code> with a method <code>speak()</code>. We then implement this trait for two different structs, <code>Dog</code> and <code>Cat</code>. The <code>speak()</code> method is implemented differently for each struct.</p><p>In the <code>main()</code> function, we create two variables <code>dog</code> and <code>cat</code> of type <code>Box&lt;dyn Animal&gt;</code>. This allows us to store objects of different types that implement the <code>Animal</code> trait. We can assign a <code>Dog</code> or <code>Cat</code> instance to these variables, and Rust will perform dynamic dispatch based on the actual type at runtime.</p><p>Finally, we call the <code>speak()</code> method on both <code>dog</code> and <code>cat</code>.</p><h2 id="give-me-a-explain-to-trait-in-rust" tabindex="-1"><a class="header-anchor" href="#give-me-a-explain-to-trait-in-rust" aria-hidden="true">#</a> give me a explain to trait in Rust</h2><p>In Rust, a trait is a way to define a set of methods that can be implemented by multiple types. Traits allow you to define shared behavior and establish a contract that types must adhere to if they implement that trait.</p><p>Here&#39;s an explanation of traits in Rust:</p><ol><li><p><strong>Defining a Trait</strong>: To define a trait, you use the <code>trait</code> keyword followed by the trait name and a set of method signatures. For example:</p><div class="language-rust line-numbers-mode" data-ext="rs"><pre class="language-rust"><code><span class="token keyword">trait</span> <span class="token type-definition class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">speak</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In this example, we define a trait called <code>Animal</code> with a single method <code>speak()</code>. Traits can also have associated types, associated constants, and additional methods.</p></li><li><p><strong>Implementing a Trait</strong>: To implement a trait for a particular type, you use the <code>impl</code> keyword followed by the trait name and the implementation block. Inside the implementation block, you provide the actual implementations of the methods defined in the trait. For example:</p><div class="language-rust line-numbers-mode" data-ext="rs"><pre class="language-rust"><code><span class="token keyword">struct</span> <span class="token type-definition class-name">Dog</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Animal</span> <span class="token keyword">for</span> <span class="token class-name">Dog</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">speak</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;{} says: Woof!&quot;</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In this example, we implement the <code>Animal</code> trait for the <code>Dog</code> struct. We provide an implementation for the <code>speak()</code> method that prints a message with the dog&#39;s name.</p></li><li><p><strong>Using Trait Objects</strong>: Trait objects allow you to store values of different types that implement a particular trait in a generic way. You can use the <code>dyn</code> keyword to create a trait object. For example:</p><div class="language-rust line-numbers-mode" data-ext="rs"><pre class="language-rust"><code><span class="token keyword">let</span> dog<span class="token punctuation">:</span> <span class="token class-name">Box</span><span class="token operator">&lt;</span><span class="token keyword">dyn</span> <span class="token class-name">Animal</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Dog</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;Buddy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Here, we create a <code>Box&lt;dyn Animal&gt;</code> to store an object of any type that implements the <code>Animal</code> trait. This provides flexibility to work with different types that share the same behavior defined by the trait.</p></li><li><p><strong>Dynamic Dispatch</strong>: When using trait objects, Rust performs dynamic dispatch to determine which implementation of a trait&#39;s method should be called at runtime. This allows the appropriate method to be invoked based on the actual type of the object. Dynamic dispatch is performed when methods are called through a trait object rather than directly on the concrete type.</p><div class="language-rust line-numbers-mode" data-ext="rs"><pre class="language-rust"><code>dog<span class="token punctuation">.</span><span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>In this example, the <code>speak()</code> method is called on the <code>dog</code> trait object. At runtime, Rust identifies the actual type of the object (<code>Dog</code>) and invokes the corresponding implementation of the <code>speak()</code> method.</p></li></ol><p>Traits are a powerful feature in Rust that enable code reuse and polymorphism. They provide a way to define shared behavior without knowing the specific types involved, promoting generic and flexible programming patterns.</p><h2 id="闭包体中的代码定义了稍后在闭包计算时对引用或值如何操作-也就影响了什么会被移-出-闭包-如有-。-帮我解释这段话" tabindex="-1"><a class="header-anchor" href="#闭包体中的代码定义了稍后在闭包计算时对引用或值如何操作-也就影响了什么会被移-出-闭包-如有-。-帮我解释这段话" aria-hidden="true">#</a> 闭包体中的代码定义了稍后在闭包计算时对引用或值如何操作（也就影响了什么会被移 出 闭包，如有）。 帮我解释这段话</h2><p>这段话的意思是，闭包体中的代码定义了在闭包计算时对引用或值的操作方式，这将决定哪些变量会被移出闭包。</p><p>闭包可以通过引用或值来捕获其周围作用域中的变量。当闭包在计算时需要访问这些变量时，它们可以以引用的方式或值的方式被捕获。</p><p>如果闭包以引用方式捕获变量，则闭包内部对变量的操作将影响原始变量本身。这意味着变量不会被移出闭包，仍然可以在闭包之后继续使用。</p><p>如果闭包以值的方式捕获变量，则闭包内部的操作将在闭包计算时复制变量的值。这意味着变量的所有权被移出闭包，只能在闭包内部使用，之后的代码无法再访问这些变量。</p><p>具体选择是以引用方式还是值的方式捕获变量，取决于闭包体中对变量的操作需求。如果需要在闭包之后继续使用变量，可以选择以引用方式捕获；如果变量只在闭包内部使用，可以选择以值的方式捕获。</p><p>总结来说，闭包体中的代码定义了对变量的操作方式，从而决定了哪些变量会被移出闭包。这样的设计可以在闭包计算时灵活地控制变量的所有权和可用性。</p><h2 id="在rust中-trait-bound-是什么意思" tabindex="-1"><a class="header-anchor" href="#在rust中-trait-bound-是什么意思" aria-hidden="true">#</a> 在Rust中 trait bound 是什么意思</h2><div class="language-rust line-numbers-mode" data-ext="rs"><pre class="language-rust"><code>
在<span class="token class-name">Rust</span>中，<span class="token class-name">Trait</span> <span class="token class-name">Bound</span>（特质限定）指的是在泛型类型参数上使用特定<span class="token keyword">trait</span>的约束条件。<span class="token class-name">Trait</span> <span class="token class-name">Bound</span>用于指定泛型类型参数必须满足的条件，以便在泛型代码中使用特定的<span class="token keyword">trait</span>中定义的方法或功能。

<span class="token class-name">Trait</span> <span class="token class-name">Bound</span>使用<span class="token keyword">where</span>关键字后跟随一个或多个<span class="token keyword">trait</span>约束条件。这些约束条件限定了泛型类型参数必须实现指定的<span class="token keyword">trait</span>。这样可以在泛型代码中使用<span class="token keyword">trait</span>中的方法或者在泛型函数中使用具体的实现类型。

以下是一个示例，展示了<span class="token class-name">Trait</span> <span class="token class-name">Bound</span>的使用：

<span class="token keyword">trait</span> <span class="token type-definition class-name">Printable</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">print</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">Person</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Printable</span> <span class="token keyword">for</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">print</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;Name: {}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">print_object</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Printable</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>obj<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    obj<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> person <span class="token operator">=</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;Alice&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">print_object</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

在上述示例中，定义了一个\`<span class="token keyword">trait</span> <span class="token type-definition class-name">Printable</span>\`，其中包含一个\`print\`方法。然后，我们创建了一个<span class="token class-name">Person</span>结构体，并为其实现了\`<span class="token class-name">Printable</span> <span class="token keyword">trait</span>\`。在\`print_object\`函数中，我们使用了\`<span class="token class-name">Trait</span> <span class="token class-name">Bound</span> <span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Printable</span>\`，表示泛型类型参数<span class="token class-name">T</span>必须实现\`<span class="token class-name">Printable</span> <span class="token keyword">trait</span>\`。然后，我们传递一个\`<span class="token class-name">Person</span>\`对象给\`print_object\`函数，因为\`<span class="token class-name">Person</span>\`实现了\`<span class="token class-name">Printable</span> <span class="token keyword">trait</span>\`。

通过在泛型类型参数上使用\`<span class="token class-name">Trait</span> <span class="token class-name">Bound</span>\`，我们可以在编译时对泛型类型进行约束，以保证它们满足特定的<span class="token keyword">trait</span>约束条件。这样可以在泛型代码中使用<span class="token keyword">trait</span>中定义的方法，提供更加通用和灵活的代码。

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="在rust-中-dyn-关键字的作用" tabindex="-1"><a class="header-anchor" href="#在rust-中-dyn-关键字的作用" aria-hidden="true">#</a> 在Rust 中 dyn 关键字的作用</h2><div class="language-rust line-numbers-mode" data-ext="rs"><pre class="language-rust"><code>在<span class="token class-name">Rust</span>中，<span class="token keyword">dyn</span>关键字用于指定<span class="token keyword">trait</span>对象的类型。

在<span class="token class-name">Rust</span>中，<span class="token keyword">trait</span>对象是指对实现了某个<span class="token keyword">trait</span>的类型进行抽象，通过<span class="token keyword">trait</span>对象可以以统一的方式访问不同类型的具体实现。使用<span class="token keyword">trait</span>对象时，通常需要将具体类型转换为<span class="token keyword">trait</span>对象类型，这时就可以使用<span class="token keyword">dyn</span>关键字来标记<span class="token keyword">trait</span>对象的类型。

具体来说，使用<span class="token keyword">dyn</span>关键字时，需要将<span class="token keyword">trait</span>指定为动态分发（dynamic dispatch），而不是静态分发（<span class="token keyword">static</span> dispatch）。动态分发允许在运行时根据具体对象的类型来调用相应的方法，而静态分发在编译时就会确定调用哪个方法。

下面是一个使用<span class="token keyword">dyn</span>关键字的示例：


<span class="token keyword">trait</span> <span class="token type-definition class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">make_sound</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">Dog</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Cat</span><span class="token punctuation">;</span>

<span class="token keyword">impl</span> <span class="token class-name">Animal</span> <span class="token keyword">for</span> <span class="token class-name">Dog</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">make_sound</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;Woof!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Animal</span> <span class="token keyword">for</span> <span class="token class-name">Cat</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">make_sound</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;Meow!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> dog<span class="token punctuation">:</span> <span class="token class-name">Box</span><span class="token operator">&lt;</span><span class="token keyword">dyn</span> <span class="token class-name">Animal</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Dog</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> cat<span class="token punctuation">:</span> <span class="token class-name">Box</span><span class="token operator">&lt;</span><span class="token keyword">dyn</span> <span class="token class-name">Animal</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Cat</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    dog<span class="token punctuation">.</span><span class="token function">make_sound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 使用trait对象调用动态分发的方法</span>
    cat<span class="token punctuation">.</span><span class="token function">make_sound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 使用trait对象调用动态分发的方法</span>
<span class="token punctuation">}</span>



在上述示例中，定义了一个<span class="token class-name">Animal</span> <span class="token keyword">trait</span>，具有make_sound方法。然后，分别为<span class="token class-name">Dog</span>和<span class="token class-name">Cat</span>类型实现了<span class="token class-name">Animal</span> <span class="token keyword">trait</span>。在main函数中，我们创建了dog和cat作为<span class="token class-name">Box</span><span class="token operator">&lt;</span><span class="token keyword">dyn</span> <span class="token class-name">Animal</span><span class="token operator">&gt;</span>类型的<span class="token keyword">trait</span>对象。使用<span class="token keyword">dyn</span>关键字标记了<span class="token class-name">Animal</span>作为动态分发，因此在调用make_sound方法时会进行动态分发，根据具体对象的类型来调用相应的方法。

总结来说，<span class="token keyword">dyn</span>关键字在<span class="token class-name">Rust</span>中用于标记<span class="token keyword">trait</span>对象的类型，指定为动态分发，使得可以在运行时根据具体对象的类型来调用相应的方法。这提供了更大的灵活性，可以在运行时决定调用哪个方法，但也会带来一些性能上的开销。

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="在rust中字符串字面值是什么意思" tabindex="-1"><a class="header-anchor" href="#在rust中字符串字面值是什么意思" aria-hidden="true">#</a> 在Rust中字符串字面值是什么意思</h2><div class="language-rust line-numbers-mode" data-ext="rs"><pre class="language-rust"><code>
在<span class="token class-name">Rust</span>中，字符串字面值（string literals）是指用双引号括起来的文本字符串。字符串字面值是一种直接写入程序代码中的字符串表示形式，可以在代码中直接使用而不需要额外的定义或分配内存。

<span class="token class-name">Rust</span>中的字符串字面值是不可变的（immutable），即一旦定义，就无法修改其内容。字符串字面值的类型是<span class="token operator">&amp;</span><span class="token keyword">str</span>，即对字符串的引用。由于字符串字面值是不可变的，因此可以被多个变量共享引用，而无需复制字符串数据本身。

以下是几个使用字符串字面值的示例：


<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> hello <span class="token operator">=</span> <span class="token string">&quot;Hello, world!&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 定义一个字符串字面值</span>
    <span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token string">&quot;Alice&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 定义另一个字符串字面值</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;{}&quot;</span><span class="token punctuation">,</span> hello<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出 &quot;Hello, world!&quot;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;My name is {}&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出 &quot;My name is Alice&quot;</span>
<span class="token punctuation">}</span>

在上述示例中，通过双引号括起来的文本字符串被称为字符串字面值。我们可以将字符串字面值赋值给变量，如hello和name。然后，我们可以使用<span class="token macro property">println!</span>宏来打印字符串字面值。注意，打印字符串字面值时，需要使用<span class="token punctuation">{</span><span class="token punctuation">}</span>作为占位符来替换字符串内容。

需要注意的是，<span class="token class-name">Rust</span>还提供了<span class="token class-name">String</span>类型，用于动态分配和可变的字符串数据。与字符串字面值不同，<span class="token class-name">String</span>类型的字符串是可变的，可以修改其内容。而字符串字面值是静态分配的，其内容在编译时就被确定下来了。

总结来说，字符串字面值是一种在<span class="token class-name">Rust</span>程序中直接使用的不可变字符串表示形式，类型为<span class="token operator">&amp;</span><span class="token keyword">str</span>。字符串字面值是静态分配的，其内容在编译时就被确定下来了，并且可以被多个变量共享引用。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="what-the-different-between-and-in-rust" tabindex="-1"><a class="header-anchor" href="#what-the-different-between-and-in-rust" aria-hidden="true">#</a> what the different between {} and {:?} in Rust</h2><div class="language-rust line-numbers-mode" data-ext="rs"><pre class="language-rust"><code><span class="token class-name">In</span> <span class="token class-name">Rust</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> and <span class="token punctuation">{</span><span class="token punctuation">:</span><span class="token operator">?</span><span class="token punctuation">}</span> are used <span class="token keyword">as</span> placeholders within format strings to print values<span class="token punctuation">.</span> <span class="token class-name">The</span> main difference between them lies <span class="token keyword">in</span> how they format and display the values<span class="token punctuation">.</span>

<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token class-name">This</span> is the default placeholder used <span class="token keyword">for</span> formatting values <span class="token keyword">in</span> <span class="token class-name">Rust</span><span class="token punctuation">.</span> <span class="token class-name">It</span> is often referred to <span class="token keyword">as</span> the <span class="token string">&quot;Display&quot;</span> placeholder<span class="token punctuation">.</span> <span class="token class-name">It</span> is used to format values that implement the <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span> <span class="token keyword">trait</span><span class="token punctuation">.</span> <span class="token class-name">This</span> placeholder is suitable <span class="token keyword">for</span> most types and provides a human<span class="token operator">-</span>readable representation of the value<span class="token punctuation">.</span> <span class="token class-name">Example</span><span class="token punctuation">:</span>


<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> text <span class="token operator">=</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;Number: {}&quot;</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Output: Number: 42</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;Text: {}&quot;</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Output: Text: Hello</span>
<span class="token punctuation">}</span>


<span class="token punctuation">{</span><span class="token punctuation">:</span><span class="token operator">?</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token class-name">This</span> is a special placeholder used <span class="token keyword">for</span> formatting values <span class="token keyword">in</span> <span class="token class-name">Rust</span><span class="token punctuation">,</span> known <span class="token keyword">as</span> the <span class="token string">&quot;Debug&quot;</span> placeholder<span class="token punctuation">.</span> <span class="token class-name">It</span> is used to format values that implement the <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Debug</span> <span class="token keyword">trait</span><span class="token punctuation">.</span> <span class="token class-name">It</span> provides a more verbose and detailed representation of the value<span class="token punctuation">,</span> primarily used <span class="token keyword">for</span> debugging purposes<span class="token punctuation">.</span> <span class="token class-name">Example</span><span class="token punctuation">:</span>

<span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Person</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    age<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> person <span class="token operator">=</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;Alice&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        age<span class="token punctuation">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;Person: {:?}&quot;</span><span class="token punctuation">,</span> person<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Output: Person: Person { name: &quot;Alice&quot;, age: 25 }</span>
<span class="token punctuation">}</span>


<span class="token class-name">In</span> the example above<span class="token punctuation">,</span> <span class="token class-name">Person</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">implements</span> the <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Debug</span> <span class="token keyword">trait</span> <span class="token type-definition class-name">using</span> the derive attribute<span class="token punctuation">.</span> <span class="token class-name">When</span> printing the person <span class="token keyword">struct</span> <span class="token type-definition class-name">using</span> <span class="token macro property">println!</span> and the <span class="token punctuation">{</span><span class="token punctuation">:</span><span class="token operator">?</span><span class="token punctuation">}</span> placeholder<span class="token punctuation">,</span> it displays a detailed representation of the <span class="token keyword">struct</span> <span class="token type-definition class-name">fields</span><span class="token punctuation">.</span>

<span class="token class-name">In</span> summary<span class="token punctuation">,</span> the <span class="token punctuation">{</span><span class="token punctuation">}</span> placeholder is used <span class="token keyword">for</span> normal display of values<span class="token punctuation">,</span> <span class="token keyword">while</span> <span class="token punctuation">{</span><span class="token punctuation">:</span><span class="token operator">?</span><span class="token punctuation">}</span> is used <span class="token keyword">for</span> a more detailed and debug representation of values<span class="token punctuation">.</span> <span class="token class-name">The</span> choice between them depends on the desired output format and the traits implemented by the value being printed<span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="在rust中str是什么" tabindex="-1"><a class="header-anchor" href="#在rust中str是什么" aria-hidden="true">#</a> 在Rust中str是什么？</h2><div class="language-rust line-numbers-mode" data-ext="rs"><pre class="language-rust"><code>
在<span class="token class-name">Rust</span>中，<span class="token keyword">str</span>是一种类型，表示字符串的切片（slice）。它是不可变的，由一个字节数组和一个指向该数组的长度组成。<span class="token keyword">str</span>类型可以用于表示任意长度的<span class="token constant">UTF</span><span class="token operator">-</span><span class="token number">8</span>编码字符串。

与<span class="token class-name">String</span>类型不同，<span class="token keyword">str</span>类型是静态分配的，即在编译时就确定了字符串的内容和长度。它通常作为引用（<span class="token operator">&amp;</span><span class="token keyword">str</span>）出现，因为字符串切片通常是对字符串的引用，而不是拥有字符串的所有权。

由于<span class="token keyword">str</span>类型是不可变的，无法直接修改其内容。要对<span class="token keyword">str</span>进行操作或修改，通常需要将其转换为可变的<span class="token class-name">String</span>类型，进行修改后再转换回<span class="token operator">&amp;</span><span class="token keyword">str</span>类型。

以下是一个使用<span class="token keyword">str</span>类型的示例：

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> greeting<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span> <span class="token operator">=</span> <span class="token string">&quot;Hello, world!&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span> <span class="token operator">=</span> <span class="token string">&quot;Alice&quot;</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;Greeting: {}&quot;</span><span class="token punctuation">,</span> greeting<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;Name: {}&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


在上述示例中，我们定义了两个<span class="token operator">&amp;</span><span class="token keyword">str</span>类型的变量：greeting和name，它们分别表示问候语和名字。然后，我们使用<span class="token macro property">println!</span>宏打印了这两个字符串切片。

需要注意的是，<span class="token operator">&amp;</span><span class="token keyword">str</span>类型是一种不可变的引用，可以在<span class="token class-name">Rust</span>中方便地处理和传递文本数据。它被广泛用于函数参数、结构体字段、以及与其他字符串相关的操作和函数中。

总结来说，<span class="token keyword">str</span>是在<span class="token class-name">Rust</span>中表示字符串切片的类型，它是不可变的、静态分配的，并以<span class="token operator">&amp;</span><span class="token keyword">str</span>的形式作为引用使用。它适用于表示任意长度的<span class="token constant">UTF</span><span class="token operator">-</span><span class="token number">8</span>编码字符串，并在<span class="token class-name">Rust</span>中广泛用于处理文本数据。

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="字符串字面值就是-slice" tabindex="-1"><a class="header-anchor" href="#字符串字面值就是-slice" aria-hidden="true">#</a> 字符串字面值就是 slice</h2><div class="language-rust line-numbers-mode" data-ext="rs"><pre class="language-rust"><code>还记得我们讲到过字符串字面值被储存在二进制文件中吗？现在知道 slice 了，我们就可以正确地理解字符串字面值了：


<span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">&quot;Hello, world!&quot;</span><span class="token punctuation">;</span>


这里 s 的类型是 <span class="token operator">&amp;</span><span class="token keyword">str</span>：它是一个指向二进制程序特定位置的 slice。这也就是为什么字符串字面值是不可变的；<span class="token operator">&amp;</span><span class="token keyword">str</span> 是一个不可变引用。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="在rust中生命周期和泛型的关系" tabindex="-1"><a class="header-anchor" href="#在rust中生命周期和泛型的关系" aria-hidden="true">#</a> 在Rust中生命周期和泛型的关系</h2><div class="language-rust line-numbers-mode" data-ext="rs"><pre class="language-rust"><code>
在<span class="token class-name">Rust</span>中，生命周期（lifetimes）和泛型（generics）是密切相关的概念，用于确保引用的有效性和合法性。

泛型允许编写可重用的代码，适用于不同类型的数据而不需要重复编写类似的代码。它可以在函数、结构体和枚举等定义中使用。使用泛型时，可以将类型参数用作占位符，表示实际类型的待定。

生命周期则用于处理引用的有效性和作用域。在<span class="token class-name">Rust</span>中，每个引用都必须有一个对应的生命周期，用于指定引用的有效范围。生命周期表示引用在内存中存在的时间，确保在使用引用时，被引用的值不会提前被释放。

泛型和生命周期的关系在于，当使用泛型的引用类型时，需要指定引用的生命周期，以确保引用的有效性。

以下是一个示例，展示了泛型和生命周期的关系：


<span class="token keyword">fn</span> <span class="token function-definition function">find_first_occurrence</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">&#39;a</span><span class="token punctuation">,</span> <span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>list<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">&#39;a</span> <span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">]</span><span class="token punctuation">,</span> target<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">&#39;a</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
    <span class="token keyword">where</span> <span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">PartialEq</span>
<span class="token punctuation">{</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> list <span class="token punctuation">{</span>
        <span class="token keyword">if</span> item <span class="token operator">==</span> target <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token class-name">Some</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">None</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> numbers <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> target <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token number">3</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">find_first_occurrence</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>numbers<span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">match</span> result <span class="token punctuation">{</span>
        <span class="token class-name">Some</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;Found: {}&quot;</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">None</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;Not found&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


在上述示例中，我们定义了一个find_first_occurrence函数，它接受一个泛型的切片和一个目标值作为参数。函数使用生命周期参数<span class="token lifetime-annotation symbol">&#39;a</span>来指定切片的生命周期，并返回一个<span class="token class-name">Option</span>类型的引用，指向第一个匹配到的目标值。在函数签名中，我们使用<span class="token keyword">where</span>子句指定了类型参数<span class="token class-name">T</span>必须实现<span class="token class-name">PartialEq</span> <span class="token keyword">trait</span>，以便可以比较值。

在main函数中，我们创建了一个整数向量numbers，并定义了一个目标值target。然后，我们调用find_first_occurrence函数，并以<span class="token operator">&amp;</span>numbers和<span class="token operator">&amp;</span>target作为参数。根据返回的结果，我们打印相应的消息。

通过使用生命周期参数<span class="token lifetime-annotation symbol">&#39;a</span>，我们确保了切片的引用在函数内部的有效性，并与传递的参数具有相同的生命周期。这样可以避免引用悬垂或无效引用的问题。

总结来说，在<span class="token class-name">Rust</span>中，泛型和生命周期密切相关，通过使用生命周期参数，可以确保引用的有效性和合法性，并允许编写可重用的泛型代码。泛型和生命周期的结合使得编写类型安全的高效代码成为可能。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="结合泛型类型参数、trait-bounds、生命周期" tabindex="-1"><a class="header-anchor" href="#结合泛型类型参数、trait-bounds、生命周期" aria-hidden="true">#</a> 结合泛型类型参数、trait bounds、生命周期</h2><div class="language-rust line-numbers-mode" data-ext="rs"><pre class="language-rust"><code>
让我们简要的看一下在同一函数中指定泛型类型参数、<span class="token keyword">trait</span> <span class="token type-definition class-name">bounds</span> 和生命周期的语法！


<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">longest_with_an_announcement</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">&#39;a</span><span class="token punctuation">,</span> <span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>
x<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">&#39;a</span> <span class="token keyword">str</span><span class="token punctuation">,</span>
y<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">&#39;a</span> <span class="token keyword">str</span><span class="token punctuation">,</span>
ann<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">&#39;a</span> <span class="token keyword">str</span>
<span class="token keyword">where</span>
<span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Display</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;Announcement! {}&quot;</span><span class="token punctuation">,</span> ann<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> x<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> y<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        x
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        y
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

这个是示例 <span class="token number">10</span><span class="token operator">-</span><span class="token number">21</span> 中那个返回两个字符串 slice 中较长者的 longest 函数，不过带有一个额外的参数 ann。ann 的类型是泛型 <span class="token class-name">T</span>，它可以被放入任何实现了 <span class="token keyword">where</span> 从句中指定的 <span class="token class-name">Display</span> <span class="token keyword">trait</span> 的类型。这个额外的参数会使用 <span class="token punctuation">{</span><span class="token punctuation">}</span> 打印，这也就是为什么 <span class="token class-name">Display</span> <span class="token keyword">trait</span> <span class="token type-definition class-name">bound</span> 是必须的。因为生命周期也是泛型，所以生命周期参数 <span class="token lifetime-annotation symbol">&#39;a</span> 和泛型类型参数 <span class="token class-name">T</span> 都位于函数名后的同一尖括号列表中。

现在你知道了泛型类型参数、<span class="token keyword">trait</span> 和 <span class="token keyword">trait</span> <span class="token type-definition class-name">bounds</span> 以及泛型生命周期类型，你已经准备好编写既不重复又能适用于多种场景的代码了。

<span class="token operator">-</span> 泛型类型参数意味着代码可以适用于不同的类型。
<span class="token operator">-</span> <span class="token keyword">trait</span> 和 <span class="token keyword">trait</span> <span class="token type-definition class-name">bounds</span> 保证了即使类型是泛型的，这些类型也会拥有所需要的行为。
<span class="token operator">-</span> 由生命周期注解所指定的引用生命周期之间的关系保证了这些灵活多变的代码不会出现悬垂引用。
  
而所有的这一切发生在编译时所以不会影响运行时效率！
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="闭包" tabindex="-1"><a class="header-anchor" href="#闭包" aria-hidden="true">#</a> 闭包</h2><ul><li>https://kaisery.github.io/trpl-zh-cn/ch13-01-closures.html</li></ul><p>一旦闭包捕获了定义它的环境中一个值的引用或者所有权（也就影响了什么会被移 进 闭包，如有)，闭包体中的代码定义了稍后在闭包计算时对引用或值如何操作（也就影响了什么会被移 出 闭包，如有）。闭包体可以做以下任何事：将一个捕获的值移出闭包，修改捕获的值，既不移动也不修改值，或者一开始就不从环境中捕获值。</p><p>闭包捕获和处理环境中的值的方式影响闭包实现的 trait。Trait 是函数和结构体指定它们能用的闭包的类型的方式。取决于闭包体如何处理值，闭包自动、渐进地实现一个、两个或三个 Fn trait。</p><ul><li>FnOnce 适用于能被调用一次的闭包，所有闭包都至少实现了这个 trait，因为所有闭包都能被调用。一个会将捕获的值移出闭包体的闭包只实现 FnOnce trait，这是因为它只能被调用一次。</li><li>FnMut 适用于不会将捕获的值移出闭包体的闭包，但它可能会修改被捕获的值。这类闭包可以被调用多次。</li><li>Fn 适用于既不将被捕获的值移出闭包体也不修改被捕获的值的闭包，当然也包括不从环境中捕获值的闭包。这类闭包可以被调用多次而不改变它们的环境，这在会多次并发调用闭包的场景中十分重要。</li></ul><div class="language-rust line-numbers-mode" data-ext="rs"><pre class="language-rust"><code><span class="token keyword">pub</span> generator_parent_path<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">Box</span><span class="token operator">&lt;</span><span class="token keyword">dyn</span> <span class="token class-name">FnOnce</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token class-name">SodaMetaDataBasic</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">String</span> <span class="token operator">+</span> <span class="token class-name">Send</span> <span class="token operator">+</span> <span class="token lifetime-annotation symbol">&#39;static</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">,</span>

error<span class="token punctuation">[</span><span class="token constant">E0507</span><span class="token punctuation">]</span><span class="token punctuation">:</span> cannot <span class="token keyword">move</span> out of \`<span class="token operator">*</span>fun\` which is behind a shared reference
   <span class="token operator">-</span><span class="token punctuation">-&gt;</span> soda_media_tools_lib\\src\\soda_media\\media_context<span class="token punctuation">.</span>rs<span class="token punctuation">:</span><span class="token number">194</span><span class="token punctuation">:</span><span class="token number">17</span>
    <span class="token operator">|</span>
<span class="token number">194</span> <span class="token operator">|</span>                 <span class="token punctuation">(</span>fun<span class="token punctuation">)</span><span class="token punctuation">(</span>target_directory<span class="token punctuation">,</span> dir_metadata<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">|</span>                 <span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
    <span class="token operator">|</span>                 <span class="token operator">|</span>
    <span class="token operator">|</span>                 \`<span class="token operator">*</span>fun\` moved due to this call
    <span class="token operator">|</span>                 <span class="token keyword">move</span> occurs because \`<span class="token operator">*</span>fun\` has <span class="token keyword">type</span> \`<span class="token class-name">Box</span><span class="token operator">&lt;</span><span class="token keyword">dyn</span> <span class="token keyword">for</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">&#39;a</span><span class="token punctuation">,</span> <span class="token lifetime-annotation symbol">&#39;b</span><span class="token operator">&gt;</span> <span class="token class-name">FnOnce</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">&#39;a</span> <span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">&#39;b</span> <span class="token class-name">SodaMetaDataBasic</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">String</span> <span class="token operator">+</span> <span class="token class-name">Send</span><span class="token operator">&gt;</span>\`<span class="token punctuation">,</span> which does not implement the \`<span class="token class-name">Copy</span>\` <span class="token keyword">trait</span>
    <span class="token operator">|</span>
note<span class="token punctuation">:</span> this value implements \`<span class="token class-name">FnOnce</span>\`<span class="token punctuation">,</span> which causes it to be moved when called
   <span class="token operator">-</span><span class="token punctuation">-&gt;</span> soda_media_tools_lib\\src\\soda_media\\media_context<span class="token punctuation">.</span>rs<span class="token punctuation">:</span><span class="token number">194</span><span class="token punctuation">:</span><span class="token number">17</span>
    <span class="token operator">|</span>
<span class="token number">194</span> <span class="token operator">|</span>                 <span class="token punctuation">(</span>fun<span class="token punctuation">)</span><span class="token punctuation">(</span>target_directory<span class="token punctuation">,</span> dir_metadata<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">|</span>                 <span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="get-tests-directory-path-in-rust" tabindex="-1"><a class="header-anchor" href="#get-tests-directory-path-in-rust" aria-hidden="true">#</a> get tests directory path in Rust</h2><p>In Rust, you can use the <code>std::env::current_dir</code> function to get the current working directory, and then append the path to your tests directory. Assuming you have a project structure like this:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>my_project/
  ├── src/
  ├── tests/
  │   └── test_module.rs
  └── Cargo.toml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You can get the path to the tests directory from within your test code like this:</p><div class="language-rust line-numbers-mode" data-ext="rs"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Get the current working directory.</span>
    <span class="token keyword">let</span> current_dir <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>env<span class="token punctuation">::</span></span><span class="token function">current_dir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to get current directory&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Append the &#39;tests&#39; directory to the current working directory.</span>
    <span class="token keyword">let</span> tests_dir <span class="token operator">=</span> current_dir<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;tests&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;Tests directory path: {:?}&quot;</span><span class="token punctuation">,</span> tests_dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This code first retrieves the current working directory using <code>std::env::current_dir()</code>, and then it appends the &quot;tests&quot; directory to the current working directory using the <code>join</code> method. Finally, it prints the path to the tests directory.</p><p>Make sure to handle any potential errors when getting the current directory, as shown in the example with <code>expect</code>.</p><h2 id="how-to-overwrite-a-file-in-rust" tabindex="-1"><a class="header-anchor" href="#how-to-overwrite-a-file-in-rust" aria-hidden="true">#</a> How to overwrite a file in Rust</h2><ul><li>https://ddanilov.me/how-to-overwrite-a-file-in-rust</li></ul><h2 id="how-to-read-and-write-yaml-in-rust-with-serde" tabindex="-1"><a class="header-anchor" href="#how-to-read-and-write-yaml-in-rust-with-serde" aria-hidden="true">#</a> How to read and write YAML in Rust with Serde</h2><ul><li>https://tms-dev-blog.com/how-to-read-and-write-yaml-in-rust-with-serde/</li></ul><h2 id="what-is-the-best-way-to-run-scheduled-concurrent-tasks-in-rust" tabindex="-1"><a class="header-anchor" href="#what-is-the-best-way-to-run-scheduled-concurrent-tasks-in-rust" aria-hidden="true">#</a> what is the best way to run scheduled concurrent tasks in rust</h2><ul><li>https://users.rust-lang.org/t/what-is-the-best-way-to-run-scheduled-concurrent-tasks-in-rust/43931</li></ul>`,54),o=[p];function c(l,i){return s(),a("div",null,o)}const r=n(t,[["render",c],["__file","learn-rust.html.vue"]]);export{r as default};
